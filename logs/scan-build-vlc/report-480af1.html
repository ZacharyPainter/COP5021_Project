<!doctype html>
<html>
<head>
<title>mul_fft.c</title>

<style type="text/css">
body { color:#000000; background-color:#ffffff }
body { font-family:Helvetica, sans-serif; font-size:10pt }
h1 { font-size:14pt }
.FileName { margin-top: 5px; margin-bottom: 5px; display: inline; }
.FileNav { margin-left: 5px; margin-right: 5px; display: inline; }
.FileNav a { text-decoration:none; font-size: larger; }
.divider { margin-top: 30px; margin-bottom: 30px; height: 15px; }
.divider { background-color: gray; }
.code { border-collapse:collapse; width:100%; }
.code { font-family: "Monospace", monospace; font-size:10pt }
.code { line-height: 1.2em }
.comment { color: green; font-style: oblique }
.keyword { color: blue }
.string_literal { color: red }
.directive { color: darkmagenta }

/* Macros and variables could have pop-up notes hidden by default.
  - Macro pop-up:    expansion of the macro
  - Variable pop-up: value (table) of the variable */
.macro_popup, .variable_popup { display: none; }

/* Pop-up appears on mouse-hover event. */
.macro:hover .macro_popup, .variable:hover .variable_popup {
  display: block;
  padding: 2px;
  -webkit-border-radius:5px;
  -webkit-box-shadow:1px 1px 7px #000;
  border-radius:5px;
  box-shadow:1px 1px 7px #000;
  position: absolute;
  top: -1em;
  left:10em;
  z-index: 1
}

.macro_popup {
  border: 2px solid red;
  background-color:#FFF0F0;
  font-weight: normal;
}

.variable_popup {
  border: 2px solid blue;
  background-color:#F0F0FF;
  font-weight: bold;
  font-family: Helvetica, sans-serif;
  font-size: 9pt;
}

/* Pop-up notes needs a relative position as a base where they pops up. */
.macro, .variable {
  background-color: PaleGoldenRod;
  position: relative;
}
.macro { color: DarkMagenta; }

#tooltiphint {
  position: fixed;
  width: 50em;
  margin-left: -25em;
  left: 50%;
  padding: 10px;
  border: 1px solid #b0b0b0;
  border-radius: 2px;
  box-shadow: 1px 1px 7px black;
  background-color: #c0c0c0;
  z-index: 2;
}

.num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
.num { text-align:right; font-size:8pt }
.num { color:#444444 }
.line { padding-left: 1ex; border-left: 3px solid #ccc }
.line { white-space: pre }
.msg { -webkit-box-shadow:1px 1px 7px #000 }
.msg { box-shadow:1px 1px 7px #000 }
.msg { -webkit-border-radius:5px }
.msg { border-radius:5px }
.msg { font-family:Helvetica, sans-serif; font-size:8pt }
.msg { float:left }
.msg { padding:0.25em 1ex 0.25em 1ex }
.msg { margin-top:10px; margin-bottom:10px }
.msg { font-weight:bold }
.msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
.msgT { padding:0x; spacing:0x }
.msgEvent { background-color:#fff8b4; color:#000000 }
.msgControl { background-color:#bbbbbb; color:#000000 }
.msgNote { background-color:#ddeeff; color:#000000 }
.mrange { background-color:#dfddf3 }
.mrange { border-bottom:1px solid #6F9DBE }
.PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
.PathIndex { -webkit-border-radius:8px }
.PathIndex { border-radius:8px }
.PathIndexEvent { background-color:#bfba87 }
.PathIndexControl { background-color:#8c8c8c }
.PathIndexPopUp { background-color: #879abc; }
.PathNav a { text-decoration:none; font-size: larger }
.CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
.CodeRemovalHint { background-color:#de1010 }
.CodeRemovalHint { border-bottom:1px solid #6F9DBE }
.selected{ background-color:orange !important; }

table.simpletable {
  padding: 5px;
  font-size:12pt;
  margin:20px;
  border-collapse: collapse; border-spacing: 0px;
}
td.rowname {
  text-align: right;
  vertical-align: top;
  font-weight: bold;
  color:#444444;
  padding-right:2ex;
}

/* Hidden text. */
input.spoilerhider + label {
  cursor: pointer;
  text-decoration: underline;
  display: block;
}
input.spoilerhider {
 display: none;
}
input.spoilerhider ~ .spoiler {
  overflow: hidden;
  margin: 10px auto 0;
  height: 0;
  opacity: 0;
}
input.spoilerhider:checked + label + .spoiler{
  height: auto;
  opacity: 1;
}
</style>
</head>
<body>
<!-- BUGDESC Although the value stored to 'cc' is used in the enclosing expression, the value is never actually read from 'cc' -->

<!-- BUGTYPE Dead nested assignment -->

<!-- BUGCATEGORY Dead store -->

<!-- BUGFILE /home/zach/vlc/contrib/native/gmp/mpn/mul_fft.c -->

<!-- FILENAME mul_fft.c -->

<!-- FUNCTIONNAME mpn_mul_fft_internal -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT 5bd5a48c35ba826f748e0a84d52acfca -->

<!-- BUGLINE 781 -->

<!-- BUGCOLUMN 12 -->

<!-- BUGPATHLENGTH 1 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>gmp/mpn/mul_fft.c</td></tr>
<tr><td class="rowname">Warning:</td><td><a href="#EndPath">line 781, column 12</a><br />Although the value stored to 'cc' is used in the enclosing expression, the value is never actually read from 'cc'</td></tr>

</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<p>Press <a href="#" onclick="toggleHelp(); return false;">'?'</a>
   to see keyboard shortcuts</p>
<input type="checkbox" class="spoilerhider" id="showinvocation" />
<label for="showinvocation" >Show analyzer invocation</label>
<div class="spoiler">clang -cc1 -triple x86_64-pc-linux-gnu -analyze -disable-free -disable-llvm-verifier -discard-value-names -main-file-name mul_fft.c -analyzer-store=region -analyzer-opt-analyze-nested-blocks -analyzer-checker=core -analyzer-checker=apiModeling -analyzer-checker=unix -analyzer-checker=deadcode -analyzer-checker=security.insecureAPI.UncheckedReturn -analyzer-checker=security.insecureAPI.getpw -analyzer-checker=security.insecureAPI.gets -analyzer-checker=security.insecureAPI.mktemp -analyzer-checker=security.insecureAPI.mkstemp -analyzer-checker=security.insecureAPI.vfork -analyzer-checker=nullability.NullPassedToNonnull -analyzer-checker=nullability.NullReturnedFromNonnull -analyzer-output plist -w -setup-static-analyzer -mrelocation-model pic -pic-level 2 -mthread-model posix -mframe-pointer=none -fmath-errno -fno-rounding-math -masm-verbose -mconstructor-aliases -munwind-tables -target-cpu x86-64 -dwarf-column-info -fno-split-dwarf-inlining -debugger-tuning=gdb -resource-dir /usr/lib/llvm-10/lib/clang/10.0.0 -D HAVE_CONFIG_H -I . -I .. -D __GMP_WITHIN_GMP -I .. -D OPERATION_mul_fft -I /home/zach/vlc/contrib/x86_64-linux-gnu/include -I /home/zach/vlc/contrib/x86_64-linux-gnu/include -D PIC -internal-isystem /usr/local/include -internal-isystem /usr/lib/llvm-10/lib/clang/10.0.0/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O2 -fdebug-compilation-dir /home/zach/vlc/contrib/native/gmp/mpn -ferror-limit 19 -fmessage-length 0 -fgnuc-version=4.2.1 -fobjc-runtime=gcc -fdiagnostics-show-option -vectorize-loops -vectorize-slp -analyzer-output=html -faddrsig -o /tmp/scan-build-2022-04-26-124449-9742-1 -x c mul_fft.c
</div>
<div id='tooltiphint' hidden="true">
  <p>Keyboard shortcuts: </p>
  <ul>
    <li>Use 'j/k' keys for keyboard navigation</li>
    <li>Use 'Shift+S' to show/hide relevant lines</li>
    <li>Use '?' to toggle this window</li>
  </ul>
  <a href="#" onclick="toggleHelp(); return false;">Close</a>
</div>
<script type='text/javascript'>
var relevant_lines = {"1": {"781": 1}};

var filterCounterexample = function (hide) {
  var tables = document.getElementsByClassName("code");
  for (var t=0; t<tables.length; t++) {
    var table = tables[t];
    var file_id = table.getAttribute("data-fileid");
    var lines_in_fid = relevant_lines[file_id];
    if (!lines_in_fid) {
      lines_in_fid = {};
    }
    var lines = table.getElementsByClassName("codeline");
    for (var i=0; i<lines.length; i++) {
        var el = lines[i];
        var lineNo = el.getAttribute("data-linenumber");
        if (!lines_in_fid[lineNo]) {
          if (hide) {
            el.setAttribute("hidden", "");
          } else {
            el.removeAttribute("hidden");
          }
        }
    }
  }
}

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "S") {
    var checked = document.getElementsByName("showCounterexample")[0].checked;
    filterCounterexample(!checked);
    document.getElementsByName("showCounterexample")[0].checked = !checked;
  } else {
    return;
  }
  event.preventDefault();
}, true);

document.addEventListener("DOMContentLoaded", function() {
    document.querySelector('input[name="showCounterexample"]').onchange=
        function (event) {
      filterCounterexample(this.checked);
    };
});
</script>

<form>
    <input type="checkbox" name="showCounterexample" id="showCounterexample" />
    <label for="showCounterexample">
       Show only relevant lines
    </label>
</form>

<script type='text/javascript'>
var digitMatcher = new RegExp("[0-9]+");

document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll(".PathNav > a").forEach(
        function(currentValue, currentIndex) {
            var hrefValue = currentValue.getAttribute("href");
            currentValue.onclick = function() {
                scrollTo(document.querySelector(hrefValue));
                return false;
            };
        });
});

var findNum = function() {
    var s = document.querySelector(".selected");
    if (!s || s.id == "EndPath") {
        return 0;
    }
    var out = parseInt(digitMatcher.exec(s.id)[0]);
    return out;
};

var scrollTo = function(el) {
    document.querySelectorAll(".selected").forEach(function(s) {
        s.classList.remove("selected");
    });
    el.classList.add("selected");
    window.scrollBy(0, el.getBoundingClientRect().top -
        (window.innerHeight / 2));
}

var move = function(num, up, numItems) {
  if (num == 1 && up || num == numItems - 1 && !up) {
    return 0;
  } else if (num == 0 && up) {
    return numItems - 1;
  } else if (num == 0 && !up) {
    return 1 % numItems;
  }
  return up ? num - 1 : num + 1;
}

var numToId = function(num) {
  if (num == 0) {
    return document.getElementById("EndPath")
  }
  return document.getElementById("Path" + num);
};

var navigateTo = function(up) {
  var numItems = document.querySelectorAll(
      ".line > .msgEvent, .line > .msgControl").length;
  var currentSelected = findNum();
  var newSelected = move(currentSelected, up, numItems);
  var newEl = numToId(newSelected, numItems);

  // Scroll element into center.
  scrollTo(newEl);
};

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "j") {
    navigateTo(/*up=*/false);
  } else if (event.key == "k") {
    navigateTo(/*up=*/true);
  } else {
    return;
  }
  event.preventDefault();
}, true);
</script>
  
<script type='text/javascript'>

var toggleHelp = function() {
    var hint = document.querySelector("#tooltiphint");
    var attributeName = "hidden";
    if (hint.hasAttribute(attributeName)) {
      hint.removeAttribute(attributeName);
    } else {
      hint.setAttribute("hidden", "true");
    }
};
window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "?") {
    toggleHelp();
  } else {
    return;
  }
  event.preventDefault();
});
</script>
<table class="code" data-fileid="1">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>/* Schoenhage's fast multiplication modulo 2^N+1.</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line">   <span class='comment'>Contributed by Paul Zimmermann.</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line">   <span class='comment'>THE FUNCTIONS IN THIS FILE ARE INTERNAL WITH MUTABLE INTERFACES.  IT IS ONLY</span></td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line">   <span class='comment'>SAFE TO REACH THEM THROUGH DOCUMENTED INTERFACES.  IN FACT, IT IS ALMOST</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line">   <span class='comment'>GUARANTEED THAT THEY WILL CHANGE OR DISAPPEAR IN A FUTURE GNU MP RELEASE.</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='comment'>Copyright 1998-2010, 2012, 2013 Free Software Foundation, Inc.</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='comment'>This file is part of the GNU MP Library.</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"><span class='comment'>The GNU MP Library is free software; you can redistribute it and/or modify</span></td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='comment'>it under the terms of either:</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line">  <span class='comment'>* the GNU Lesser General Public License as published by the Free</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line">    <span class='comment'>Software Foundation; either version 3 of the License, or (at your</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line">    <span class='comment'>option) any later version.</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"><span class='comment'>or</span></td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line">  <span class='comment'>* the GNU General Public License as published by the Free Software</span></td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line">    <span class='comment'>Foundation; either version 2 of the License, or (at your option) any</span></td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line">    <span class='comment'>later version.</span></td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"><span class='comment'>or both in parallel, as here.</span></td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"><span class='comment'>The GNU MP Library is distributed in the hope that it will be useful, but</span></td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line"><span class='comment'>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span></td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line"><span class='comment'>or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span></td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line"><span class='comment'>for more details.</span></td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"><span class='comment'>You should have received copies of the GNU General Public License and the</span></td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"><span class='comment'>GNU Lesser General Public License along with the GNU MP Library.  If not,</span></td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"><span class='comment'>see https://www.gnu.org/licenses/.  */</span></td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line"><span class='comment'>/* References:</span></td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line">   <span class='comment'>Schnelle Multiplikation grosser Zahlen, by Arnold Schoenhage and Volker</span></td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line">   <span class='comment'>Strassen, Computing 7, p. 281-292, 1971.</span></td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line">   <span class='comment'>Asymptotically fast algorithms for the numerical multiplication and division</span></td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line">   <span class='comment'>of polynomials with complex coefficients, by Arnold Schoenhage, Computer</span></td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line">   <span class='comment'>Algebra, EUROCAM'82, LNCS 144, p. 3-15, 1982.</span></td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line">   <span class='comment'>Tapes versus Pointers, a study in implementing fast algorithms, by Arnold</span></td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line">   <span class='comment'>Schoenhage, Bulletin of the EATCS, 30, p. 23-32, 1986.</span></td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line">   <span class='comment'>TODO:</span></td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line">   <span class='comment'>Implement some of the tricks published at ISSAC'2007 by Gaudry, Kruppa, and</span></td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line">   <span class='comment'>Zimmermann.</span></td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line">   <span class='comment'>It might be possible to avoid a small number of MPN_COPYs by using a</span></td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line">   <span class='comment'>rotating temporary or two.</span></td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line">   <span class='comment'>Cleanup and simplify the code!</span></td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"><span class='directive'>#ifdef TRACE</span></td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"><span class='directive'>#undef TRACE</span></td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line"><span class='directive'>#define TRACE(x) x</span></td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line"><span class='directive'>#include &lt;stdio.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line"><span class='directive'>#define TRACE(x)</span></td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line"><span class='directive'>#include "gmp.h"</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line"><span class='directive'>#include "gmp-impl.h"</span></td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line"><span class='directive'>#ifdef WANT_ADDSUB</span></td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line"><span class='directive'>#include "generic/add_n_sub_n.c"</span></td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line"><span class='directive'>#define HAVE_NATIVE_mpn_add_n_sub_n 1</span></td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"><span class='keyword'>static</span> mp_limb_t mpn_mul_fft_internal (mp_ptr, mp_size_t, <span class='keyword'>int</span>, mp_ptr *,</td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line">				       mp_ptr *, mp_ptr, mp_ptr, mp_size_t,</td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line">				       mp_size_t, mp_size_t, <span class='keyword'>int</span> **, mp_ptr, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span> mpn_mul_fft_decompose (mp_ptr, mp_ptr *, mp_size_t, mp_size_t, mp_srcptr,</td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line">				   mp_size_t, mp_size_t, mp_size_t, mp_ptr);</td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line"><span class='comment'>/* Find the best k to use for a mod 2^(m*GMP_NUMB_BITS)+1 FFT for m &gt;= n.</span></td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line">   <span class='comment'>We have sqr=0 if for a multiply, sqr=1 for a square.</span></td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line">   <span class='comment'>There are three generations of this code; we keep the old ones as long as</span></td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line">   <span class='comment'>some gmp-mparam.h is not updated.  */</span></td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line"><span class='comment'>/*****************************************************************************/</span></td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line"><span class='directive'>#if TUNE_PROGRAM_BUILD || (defined (<span class='macro'>MUL_FFT_TABLE3<span class='macro_popup'>{ { 654, 5}, { 21, 6}, { 11, 5}, { 23, 6}, { 12, 5}, { 25, 6}<br>, { 13, 5}, { 27, 6}, { 15, 5}, { 31, 6}, { 27, 7}, { 15, 6},<br> { 31, 7}, { 19, 6}, { 39, 7}, { 29, 8}, { 15, 7}, { 33, 8}, {<br> 17, 7}, { 37, 8}, { 19, 7}, { 39, 8}, { 23, 7}, { 47, 8}, { 25<br>, 7}, { 51, 8}, { 43, 9}, { 23, 8}, { 51, 9}, { 27, 8}, { 57,<br> 9}, { 31, 8}, { 65, 9}, { 35, 8}, { 71, 9}, { 39, 8}, { 79, 9<br>}, { 43,10}, { 23, 9}, { 59, 8}, { 119,10}, { 31, 8}, { 125, 9<br>}, { 71,10}, { 39, 9}, { 87,10}, { 47, 9}, { 99,10}, { 55, 9}<br>, { 123,11}, { 31,10}, { 63, 9}, { 131,10}, { 71, 9}, { 143,10<br>}, { 79, 9}, { 159,10}, { 87,11}, { 47,10}, { 119,11}, { 63,10<br>}, { 143,11}, { 79,10}, { 175,11}, { 95,10}, { 199,11}, { 111<br>,10}, { 223,12}, { 63,11}, { 143,10}, { 287, 9}, { 575,10}, {<br> 295,11}, { 159,10}, { 319,11}, { 175,12}, { 95,11}, { 191,10<br>}, { 383,11}, { 207,10}, { 415, 9}, { 831,11}, { 223,10}, { 447<br>,13}, { 63,12}, { 127,11}, { 255,10}, { 511,11}, { 271,10}, {<br> 543, 9}, { 1087,11}, { 287,10}, { 575, 9}, { 1151,12}, { 159<br>,11}, { 319,10}, { 639,11}, { 335,10}, { 671,11}, { 351,10}, {<br> 703,11}, { 367,12}, { 191,11}, { 383,10}, { 767,11}, { 399,10<br>}, { 799,11}, { 415,10}, { 831,12}, { 223,11}, { 447,10}, { 895<br>,11}, { 479,13}, { 127,12}, { 255,11}, { 511,10}, { 1023,11},<br> { 543,10}, { 1087,12}, { 287,11}, { 575,10}, { 1151,11}, { 607<br>,12}, { 319,11}, { 639,10}, { 1279,11}, { 671,12}, { 351,11},<br> { 703,10}, { 1407,13}, { 191,12}, { 383,11}, { 767,12}, { 415<br>,11}, { 831,12}, { 447,11}, { 895,12}, { 479,11}, { 959,14}, {<br> 127,13}, { 255,12}, { 511,11}, { 1023,12}, { 543,11}, { 1087<br>,12}, { 575,11}, { 1151,12}, { 607,11}, { 1215,13}, { 319,12}<br>, { 671,11}, { 1343,12}, { 735,13}, { 383,12}, { 799,11}, { 1599<br>,12}, { 863,13}, { 447,12}, { 895,11}, { 1791,12}, { 991,13},<br> { 511,12}, { 1087,13}, { 575,12}, { 1215,13}, { 639,12}, { 1343<br>,13}, { 703,12}, { 1471,14}, { 383,13}, { 767,12}, { 1599,13}<br>, { 831,12}, { 1663,13}, { 895,12}, { 1791,13}, { 959,12}, { 1919<br>,14}, { 511,13}, { 1087,12}, { 2175,13}, { 1215,14}, { 639,13<br>}, { 1471,14}, { 767,13}, { 1663,14}, { 895,13}, { 1919,15}, {<br> 511,14}, { 1023,13}, { 2175,14}, { 1151,13}, { 2367,14}, { 1279<br>,13}, { 2559,14}, { 1407,15}, { 32768,16}, { 65536,17}, { 131072<br>,18}, { 262144,19}, { 524288,20}, {1048576,21}, {2097152,22},<br> {4194304,23}, {8388608,24} }</span></span>) &amp;&amp; defined (<span class='macro'>SQR_FFT_TABLE3<span class='macro_popup'>{ { 570, 5}, { 21, 6}, { 11, 5}, { 23, 6}, { 12, 5}, { 25, 6}<br>, { 13, 5}, { 27, 6}, { 14, 5}, { 29, 6}, { 16, 5}, { 33, 6},<br> { 29, 7}, { 15, 6}, { 31, 7}, { 16, 6}, { 33, 7}, { 17, 6}, {<br> 35, 7}, { 33, 8}, { 17, 7}, { 37, 8}, { 19, 7}, { 40, 8}, { 21<br>, 7}, { 43, 8}, { 23, 7}, { 47, 8}, { 25, 7}, { 51, 8}, { 29,<br> 9}, { 15, 8}, { 37, 9}, { 19, 8}, { 43, 9}, { 23, 8}, { 51, 9<br>}, { 27, 8}, { 55, 9}, { 31, 8}, { 63, 9}, { 35, 8}, { 71, 9}<br>, { 39, 8}, { 79, 9}, { 43,10}, { 23, 9}, { 55,10}, { 31, 9},<br> { 71,10}, { 39, 9}, { 83,10}, { 47, 9}, { 99,10}, { 55, 9}, {<br> 123,11}, { 31,10}, { 63, 9}, { 127,10}, { 71, 9}, { 143,10},<br> { 87,11}, { 47,10}, { 111,12}, { 31,11}, { 63,10}, { 143,11}<br>, { 79,10}, { 167,11}, { 95,10}, { 199,11}, { 111,12}, { 63,11<br>}, { 127, 9}, { 511,11}, { 143,10}, { 287, 9}, { 575, 8}, { 1151<br>,11}, { 159,10}, { 319, 9}, { 639,11}, { 175,12}, { 95,11}, {<br> 191,10}, { 383, 9}, { 767,11}, { 207,10}, { 415, 9}, { 831,10<br>}, { 431,11}, { 223,10}, { 447,13}, { 63,12}, { 127,10}, { 511<br>, 9}, { 1023,10}, { 543, 9}, { 1087,11}, { 287,10}, { 575, 9}<br>, { 1151,12}, { 159,11}, { 319,10}, { 639, 9}, { 1279,11}, { 335<br>,10}, { 671,11}, { 351,10}, { 703,11}, { 367,12}, { 191,11}, {<br> 383,10}, { 767,11}, { 399,10}, { 799,11}, { 415,10}, { 831,11<br>}, { 431,12}, { 223,11}, { 447,10}, { 895,11}, { 463,13}, { 127<br>,11}, { 511,10}, { 1023,11}, { 543,10}, { 1087,12}, { 287,11}<br>, { 575,10}, { 1151,11}, { 607,10}, { 1215,12}, { 319,11}, { 639<br>,10}, { 1279,11}, { 671,12}, { 351,11}, { 703,10}, { 1407,13}<br>, { 191,12}, { 383,11}, { 767,10}, { 1535,11}, { 799,12}, { 415<br>,11}, { 831,12}, { 447,11}, { 895,12}, { 479,14}, { 127,12}, {<br> 511,11}, { 1023,12}, { 543,11}, { 1087,12}, { 575,11}, { 1151<br>,12}, { 607,11}, { 1215,13}, { 319,12}, { 639,11}, { 1279,12}<br>, { 671,11}, { 1343,12}, { 703,11}, { 1407,12}, { 735,13}, { 383<br>,12}, { 799,11}, { 1599,12}, { 863,13}, { 447,12}, { 959,13},<br> { 511,12}, { 1087,13}, { 575,12}, { 1215,13}, { 639,12}, { 1343<br>,13}, { 703,12}, { 1471,14}, { 383,13}, { 767,12}, { 1599,13}<br>, { 831,12}, { 1663,13}, { 895,12}, { 1791,13}, { 959,14}, { 511<br>,13}, { 1023,12}, { 2047,13}, { 1215,14}, { 639,13}, { 1471,14<br>}, { 767,13}, { 1663,14}, { 895,13}, { 1855,15}, { 511,14}, {<br> 1023,13}, { 2111,14}, { 1151,13}, { 2303,14}, { 1407,15}, { 32768<br>,16}, { 65536,17}, { 131072,18}, { 262144,19}, { 524288,20}, {<br>1048576,21}, {2097152,22}, {4194304,23}, {8388608,24} }</span></span>))</span></td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line"><span class='directive'>#ifndef <span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span>		/* When tuning this is defined in gmp-impl.h */</span></td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line"><span class='directive'>#if defined (<span class='macro'>MUL_FFT_TABLE3_SIZE<span class='macro_popup'>205</span></span>) &amp;&amp; defined (<span class='macro'>SQR_FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line"><span class='directive'>#if <span class='macro'>MUL_FFT_TABLE3_SIZE<span class='macro_popup'>205</span></span> &gt; <span class='macro'>SQR_FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span></span></td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line"><span class='directive'>#define <span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span> <span class='macro'>MUL_FFT_TABLE3_SIZE<span class='macro_popup'>205</span></span></span></td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line"><span class='directive'>#define <span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span> <span class='macro'>SQR_FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span></span></td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line"><span class='directive'>#ifndef <span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span></span></td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line"><span class='directive'>#define <span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span> 200</span></td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line"><span class='macro'>FFT_TABLE_ATTRS<span class='macro_popup'>static const</span></span> <span class='keyword'>struct</span> fft_table_nk mpn_fft_table3[2][<span class='macro'>FFT_TABLE3_SIZE<span class='macro_popup'>214</span></span>] =</td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line">  <span class='macro'>MUL_FFT_TABLE3<span class='macro_popup'>{ { 654, 5}, { 21, 6}, { 11, 5}, { 23, 6}, { 12, 5}, { 25, 6}<br>, { 13, 5}, { 27, 6}, { 15, 5}, { 31, 6}, { 27, 7}, { 15, 6},<br> { 31, 7}, { 19, 6}, { 39, 7}, { 29, 8}, { 15, 7}, { 33, 8}, {<br> 17, 7}, { 37, 8}, { 19, 7}, { 39, 8}, { 23, 7}, { 47, 8}, { 25<br>, 7}, { 51, 8}, { 43, 9}, { 23, 8}, { 51, 9}, { 27, 8}, { 57,<br> 9}, { 31, 8}, { 65, 9}, { 35, 8}, { 71, 9}, { 39, 8}, { 79, 9<br>}, { 43,10}, { 23, 9}, { 59, 8}, { 119,10}, { 31, 8}, { 125, 9<br>}, { 71,10}, { 39, 9}, { 87,10}, { 47, 9}, { 99,10}, { 55, 9}<br>, { 123,11}, { 31,10}, { 63, 9}, { 131,10}, { 71, 9}, { 143,10<br>}, { 79, 9}, { 159,10}, { 87,11}, { 47,10}, { 119,11}, { 63,10<br>}, { 143,11}, { 79,10}, { 175,11}, { 95,10}, { 199,11}, { 111<br>,10}, { 223,12}, { 63,11}, { 143,10}, { 287, 9}, { 575,10}, {<br> 295,11}, { 159,10}, { 319,11}, { 175,12}, { 95,11}, { 191,10<br>}, { 383,11}, { 207,10}, { 415, 9}, { 831,11}, { 223,10}, { 447<br>,13}, { 63,12}, { 127,11}, { 255,10}, { 511,11}, { 271,10}, {<br> 543, 9}, { 1087,11}, { 287,10}, { 575, 9}, { 1151,12}, { 159<br>,11}, { 319,10}, { 639,11}, { 335,10}, { 671,11}, { 351,10}, {<br> 703,11}, { 367,12}, { 191,11}, { 383,10}, { 767,11}, { 399,10<br>}, { 799,11}, { 415,10}, { 831,12}, { 223,11}, { 447,10}, { 895<br>,11}, { 479,13}, { 127,12}, { 255,11}, { 511,10}, { 1023,11},<br> { 543,10}, { 1087,12}, { 287,11}, { 575,10}, { 1151,11}, { 607<br>,12}, { 319,11}, { 639,10}, { 1279,11}, { 671,12}, { 351,11},<br> { 703,10}, { 1407,13}, { 191,12}, { 383,11}, { 767,12}, { 415<br>,11}, { 831,12}, { 447,11}, { 895,12}, { 479,11}, { 959,14}, {<br> 127,13}, { 255,12}, { 511,11}, { 1023,12}, { 543,11}, { 1087<br>,12}, { 575,11}, { 1151,12}, { 607,11}, { 1215,13}, { 319,12}<br>, { 671,11}, { 1343,12}, { 735,13}, { 383,12}, { 799,11}, { 1599<br>,12}, { 863,13}, { 447,12}, { 895,11}, { 1791,12}, { 991,13},<br> { 511,12}, { 1087,13}, { 575,12}, { 1215,13}, { 639,12}, { 1343<br>,13}, { 703,12}, { 1471,14}, { 383,13}, { 767,12}, { 1599,13}<br>, { 831,12}, { 1663,13}, { 895,12}, { 1791,13}, { 959,12}, { 1919<br>,14}, { 511,13}, { 1087,12}, { 2175,13}, { 1215,14}, { 639,13<br>}, { 1471,14}, { 767,13}, { 1663,14}, { 895,13}, { 1919,15}, {<br> 511,14}, { 1023,13}, { 2175,14}, { 1151,13}, { 2367,14}, { 1279<br>,13}, { 2559,14}, { 1407,15}, { 32768,16}, { 65536,17}, { 131072<br>,18}, { 262144,19}, { 524288,20}, {1048576,21}, {2097152,22},<br> {4194304,23}, {8388608,24} }</span></span>,</td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line">  <span class='macro'>SQR_FFT_TABLE3<span class='macro_popup'>{ { 570, 5}, { 21, 6}, { 11, 5}, { 23, 6}, { 12, 5}, { 25, 6}<br>, { 13, 5}, { 27, 6}, { 14, 5}, { 29, 6}, { 16, 5}, { 33, 6},<br> { 29, 7}, { 15, 6}, { 31, 7}, { 16, 6}, { 33, 7}, { 17, 6}, {<br> 35, 7}, { 33, 8}, { 17, 7}, { 37, 8}, { 19, 7}, { 40, 8}, { 21<br>, 7}, { 43, 8}, { 23, 7}, { 47, 8}, { 25, 7}, { 51, 8}, { 29,<br> 9}, { 15, 8}, { 37, 9}, { 19, 8}, { 43, 9}, { 23, 8}, { 51, 9<br>}, { 27, 8}, { 55, 9}, { 31, 8}, { 63, 9}, { 35, 8}, { 71, 9}<br>, { 39, 8}, { 79, 9}, { 43,10}, { 23, 9}, { 55,10}, { 31, 9},<br> { 71,10}, { 39, 9}, { 83,10}, { 47, 9}, { 99,10}, { 55, 9}, {<br> 123,11}, { 31,10}, { 63, 9}, { 127,10}, { 71, 9}, { 143,10},<br> { 87,11}, { 47,10}, { 111,12}, { 31,11}, { 63,10}, { 143,11}<br>, { 79,10}, { 167,11}, { 95,10}, { 199,11}, { 111,12}, { 63,11<br>}, { 127, 9}, { 511,11}, { 143,10}, { 287, 9}, { 575, 8}, { 1151<br>,11}, { 159,10}, { 319, 9}, { 639,11}, { 175,12}, { 95,11}, {<br> 191,10}, { 383, 9}, { 767,11}, { 207,10}, { 415, 9}, { 831,10<br>}, { 431,11}, { 223,10}, { 447,13}, { 63,12}, { 127,10}, { 511<br>, 9}, { 1023,10}, { 543, 9}, { 1087,11}, { 287,10}, { 575, 9}<br>, { 1151,12}, { 159,11}, { 319,10}, { 639, 9}, { 1279,11}, { 335<br>,10}, { 671,11}, { 351,10}, { 703,11}, { 367,12}, { 191,11}, {<br> 383,10}, { 767,11}, { 399,10}, { 799,11}, { 415,10}, { 831,11<br>}, { 431,12}, { 223,11}, { 447,10}, { 895,11}, { 463,13}, { 127<br>,11}, { 511,10}, { 1023,11}, { 543,10}, { 1087,12}, { 287,11}<br>, { 575,10}, { 1151,11}, { 607,10}, { 1215,12}, { 319,11}, { 639<br>,10}, { 1279,11}, { 671,12}, { 351,11}, { 703,10}, { 1407,13}<br>, { 191,12}, { 383,11}, { 767,10}, { 1535,11}, { 799,12}, { 415<br>,11}, { 831,12}, { 447,11}, { 895,12}, { 479,14}, { 127,12}, {<br> 511,11}, { 1023,12}, { 543,11}, { 1087,12}, { 575,11}, { 1151<br>,12}, { 607,11}, { 1215,13}, { 319,12}, { 639,11}, { 1279,12}<br>, { 671,11}, { 1343,12}, { 703,11}, { 1407,12}, { 735,13}, { 383<br>,12}, { 799,11}, { 1599,12}, { 863,13}, { 447,12}, { 959,13},<br> { 511,12}, { 1087,13}, { 575,12}, { 1215,13}, { 639,12}, { 1343<br>,13}, { 703,12}, { 1471,14}, { 383,13}, { 767,12}, { 1599,13}<br>, { 831,12}, { 1663,13}, { 895,12}, { 1791,13}, { 959,14}, { 511<br>,13}, { 1023,12}, { 2047,13}, { 1215,14}, { 639,13}, { 1471,14<br>}, { 767,13}, { 1663,14}, { 895,13}, { 1855,15}, { 511,14}, {<br> 1023,13}, { 2111,14}, { 1151,13}, { 2303,14}, { 1407,15}, { 32768<br>,16}, { 65536,17}, { 131072,18}, { 262144,19}, { 524288,20}, {<br>1048576,21}, {2097152,22}, {4194304,23}, {8388608,24} }</span></span></td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line"><span class='keyword'>int</span></td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line"><span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (mp_size_t n, <span class='keyword'>int</span> sqr)</td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line">  <span class='keyword'>const</span> <span class='keyword'>struct</span> fft_table_nk *fft_tab, *tab;</td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line">  mp_size_t tab_n, thres;</td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line">  <span class='keyword'>int</span> last_k;</td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line">  fft_tab = mpn_fft_table3[sqr];</td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line">  last_k = fft_tab-&gt;k;</td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line">  <span class='keyword'>for</span> (tab = fft_tab + 1; ; tab++)</td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line">      tab_n = tab-&gt;n;</td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line">      thres = tab_n &lt;&lt; last_k;</td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line">      <span class='keyword'>if</span> (n &lt;= thres)</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line">	<span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line">      last_k = tab-&gt;k;</td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line">  <span class='keyword'>return</span> last_k;</td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line"><span class='directive'>#define <span class='macro'>MPN_FFT_BEST_READY<span class='macro_popup'>1</span></span> 1</span></td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line"><span class='comment'>/*****************************************************************************/</span></td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line"><span class='directive'>#if ! defined (<span class='macro'>MPN_FFT_BEST_READY<span class='macro_popup'>1</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line"><span class='macro'>FFT_TABLE_ATTRS<span class='macro_popup'>static const</span></span> mp_size_t mpn_fft_table[2][<span class='macro'>MPN_FFT_TABLE_SIZE<span class='macro_popup'>16</span></span>] =</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line">  <span class='macro'>MUL_FFT_TABLE<span class='macro_popup'>{ 81 * 4, 81 * 8, 81 * 16, 81 * 32, 81 * 96, 81 * 288, 0 }</span></span>,</td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line">  <span class='macro'>SQR_FFT_TABLE<span class='macro_popup'>{ 129 * 4, 129 * 8, 129 * 16, 129 * 32, 129 * 96, 129 * 288, 0<br> }</span></span></td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line"><span class='keyword'>int</span></td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line"><span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (mp_size_t n, <span class='keyword'>int</span> sqr)</td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line">  <span class='keyword'>int</span> i;</td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line">  <span class='keyword'>for</span> (i = 0; mpn_fft_table[sqr][i] != 0; i++)</td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line">    <span class='keyword'>if</span> (n &lt; mpn_fft_table[sqr][i])</td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line">      <span class='keyword'>return</span> i + <span class='macro'>FFT_FIRST_K<span class='macro_popup'>4</span></span>;</td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line">  <span class='comment'>/* treat 4*last as one further entry */</span></td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line">  <span class='keyword'>if</span> (i == 0 || n &lt; 4 * mpn_fft_table[sqr][i - 1])</td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line">    <span class='keyword'>return</span> i + <span class='macro'>FFT_FIRST_K<span class='macro_popup'>4</span></span>;</td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line">    <span class='keyword'>return</span> i + <span class='macro'>FFT_FIRST_K<span class='macro_popup'>4</span></span> + 1;</td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line"><span class='comment'>/*****************************************************************************/</span></td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line"><span class='comment'>/* Returns smallest possible number of limbs &gt;= pl for a fft of size 2^k,</span></td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line">   <span class='comment'>i.e. smallest multiple of 2^k &gt;= pl.</span></td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line">   <span class='comment'>Don't declare static: needed by tuneup.</span></td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line">mp_size_t</td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line"><span class='macro'>mpn_fft_next_size<span class='macro_popup'>__gmpn_fft_next_size</span></span> (mp_size_t pl, <span class='keyword'>int</span> k)</td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line">  pl = 1 + ((pl - 1) &gt;&gt; k); <span class='comment'>/* ceil (pl/2^k) */</span></td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line">  <span class='keyword'>return</span> pl &lt;&lt; k;</td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line"><span class='comment'>/* Initialize l[i][j] with bitrev(j) */</span></td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line">mpn_fft_initl (<span class='keyword'>int</span> **l, <span class='keyword'>int</span> k)</td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line">  <span class='keyword'>int</span> i, j, K;</td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">  <span class='keyword'>int</span> *li;</td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">  l[0][0] = 0;</td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line">  <span class='keyword'>for</span> (i = 1, K = 1; i &lt;= k; i++, K *= 2)</td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line">      li = l[i];</td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line">      <span class='keyword'>for</span> (j = 0; j &lt; K; j++)</td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line">	  li[j] = 2 * l[i - 1][j];</td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line">	  li[K + j] = 1 + li[j];</td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line"><span class='comment'>/* r &lt;- a*2^d mod 2^(n*GMP_NUMB_BITS)+1 with a = {a, n+1}</span></td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line">   <span class='comment'>Assumes a is semi-normalized, i.e. a[n] &lt;= 1.</span></td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line">   <span class='comment'>r and a must have n+1 limbs, and not overlap.</span></td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line">mpn_fft_mul_2exp_modF (mp_ptr r, mp_srcptr a, mp_bitcnt_t d, mp_size_t n)</td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line">  <span class='keyword'>unsigned</span> <span class='keyword'>int</span> sh;</td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line">  mp_size_t m;</td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line">  mp_limb_t cc, rd;</td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line">  sh = d % <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line">  m = d / <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line">  <span class='keyword'>if</span> (m &gt;= n)			<span class='comment'>/* negate */</span></td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line">      <span class='comment'>/* r[0..m-1]  &lt;-- lshift(a[n-m]..a[n-1], sh)</span></td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line">	 <span class='comment'>r[m..n-1]  &lt;-- -lshift(a[0]..a[n-m-1],  sh) */</span></td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line">      m -= n;</td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">      <span class='keyword'>if</span> (sh != 0)</td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line">	  <span class='comment'>/* no out shift below since a[n] &lt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line">	  <span class='macro'>mpn_lshift<span class='macro_popup'>__gmpn_lshift</span></span> (r, a + n - m, m + 1, sh);</td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line">	  rd = r[m];</td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line">	  cc = <span class='macro'>mpn_lshiftc<span class='macro_popup'>__gmpn_lshiftc</span></span> (r + m, a, n - m, sh);</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line">	  <span class='macro'>MPN_COPY (r, a + n - m, m)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (r, a + n - m, m); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line">	  rd = a[n];</td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line">	  <span class='macro'>mpn_com<span class='macro_popup'>__gmpn_com</span></span> (r + m, a, n - m);</td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line">	  cc = 0;</td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">      <span class='comment'>/* add cc to r[0], and add rd to r[m] */</span></td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line">      <span class='comment'>/* now add 1 in r[m], subtract 1 in r[n], i.e. add 1 in r[0] */</span></td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line">      r[n] = 0;</td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line">      <span class='comment'>/* cc &lt; 2^sh &lt;= 2^(GMP_NUMB_BITS-1) thus no overflow here */</span></td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line">      cc++;</td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line">      <span class='macro'>mpn_incr_u (r, cc)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (cc) &amp;&amp;<br> (cc) == 0) { } else if (__builtin_constant_p (cc) &amp;&amp;<br> (cc) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top"<br> ":\n" "\t" "addq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t"<br> ".L" "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof<br>(mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "addq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "addq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (cc)), "n"<br> (sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line">      rd++;</td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line">      <span class='comment'>/* rd might overflow when sh=GMP_NUMB_BITS-1 */</span></td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line">      cc = (rd == 0) ? 1 : rd;</td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line">      r = r + m + (rd == 0);</td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line">      <span class='macro'>mpn_incr_u (r, cc)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (cc) &amp;&amp;<br> (cc) == 0) { } else if (__builtin_constant_p (cc) &amp;&amp;<br> (cc) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top"<br> ":\n" "\t" "addq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t"<br> ".L" "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof<br>(mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "addq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "addq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (cc)), "n"<br> (sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="252"><td class="num" id="LN252">252</td><td class="line">      <span class='comment'>/* r[0..m-1]  &lt;-- -lshift(a[n-m]..a[n-1], sh)</span></td></tr>
<tr class="codeline" data-linenumber="253"><td class="num" id="LN253">253</td><td class="line">	 <span class='comment'>r[m..n-1]  &lt;-- lshift(a[0]..a[n-m-1],  sh)  */</span></td></tr>
<tr class="codeline" data-linenumber="254"><td class="num" id="LN254">254</td><td class="line">      <span class='keyword'>if</span> (sh != 0)</td></tr>
<tr class="codeline" data-linenumber="255"><td class="num" id="LN255">255</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="256"><td class="num" id="LN256">256</td><td class="line">	  <span class='comment'>/* no out bits below since a[n] &lt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="257"><td class="num" id="LN257">257</td><td class="line">	  <span class='macro'>mpn_lshiftc<span class='macro_popup'>__gmpn_lshiftc</span></span> (r, a + n - m, m + 1, sh);</td></tr>
<tr class="codeline" data-linenumber="258"><td class="num" id="LN258">258</td><td class="line">	  rd = ~r[m];</td></tr>
<tr class="codeline" data-linenumber="259"><td class="num" id="LN259">259</td><td class="line">	  <span class='comment'>/* {r, m+1} = {a+n-m, m+1} &lt;&lt; sh */</span></td></tr>
<tr class="codeline" data-linenumber="260"><td class="num" id="LN260">260</td><td class="line">	  cc = <span class='macro'>mpn_lshift<span class='macro_popup'>__gmpn_lshift</span></span> (r + m, a, n - m, sh); <span class='comment'>/* {r+m, n-m} = {a, n-m}&lt;&lt;sh */</span></td></tr>
<tr class="codeline" data-linenumber="261"><td class="num" id="LN261">261</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="262"><td class="num" id="LN262">262</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="263"><td class="num" id="LN263">263</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="264"><td class="num" id="LN264">264</td><td class="line">	  <span class='comment'>/* r[m] is not used below, but we save a test for m=0 */</span></td></tr>
<tr class="codeline" data-linenumber="265"><td class="num" id="LN265">265</td><td class="line">	  <span class='macro'>mpn_com<span class='macro_popup'>__gmpn_com</span></span> (r, a + n - m, m + 1);</td></tr>
<tr class="codeline" data-linenumber="266"><td class="num" id="LN266">266</td><td class="line">	  rd = a[n];</td></tr>
<tr class="codeline" data-linenumber="267"><td class="num" id="LN267">267</td><td class="line">	  <span class='macro'>MPN_COPY (r + m, a, n - m)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (r + m, a, n - m); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="268"><td class="num" id="LN268">268</td><td class="line">	  cc = 0;</td></tr>
<tr class="codeline" data-linenumber="269"><td class="num" id="LN269">269</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="270"><td class="num" id="LN270">270</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="271"><td class="num" id="LN271">271</td><td class="line">      <span class='comment'>/* now complement {r, m}, subtract cc from r[0], subtract rd from r[m] */</span></td></tr>
<tr class="codeline" data-linenumber="272"><td class="num" id="LN272">272</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="273"><td class="num" id="LN273">273</td><td class="line">      <span class='comment'>/* if m=0 we just have r[0]=a[n] &lt;&lt; sh */</span></td></tr>
<tr class="codeline" data-linenumber="274"><td class="num" id="LN274">274</td><td class="line">      <span class='keyword'>if</span> (m != 0)</td></tr>
<tr class="codeline" data-linenumber="275"><td class="num" id="LN275">275</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="276"><td class="num" id="LN276">276</td><td class="line">	  <span class='comment'>/* now add 1 in r[0], subtract 1 in r[m] */</span></td></tr>
<tr class="codeline" data-linenumber="277"><td class="num" id="LN277">277</td><td class="line">	  <span class='keyword'>if</span> (cc-- == 0) <span class='comment'>/* then add 1 to r[0] */</span></td></tr>
<tr class="codeline" data-linenumber="278"><td class="num" id="LN278">278</td><td class="line">	    cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (r, r, n, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="279"><td class="num" id="LN279">279</td><td class="line">	  cc = <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (r, r, m, cc) + 1;</td></tr>
<tr class="codeline" data-linenumber="280"><td class="num" id="LN280">280</td><td class="line">	  <span class='comment'>/* add 1 to cc instead of rd since rd might overflow */</span></td></tr>
<tr class="codeline" data-linenumber="281"><td class="num" id="LN281">281</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="282"><td class="num" id="LN282">282</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="283"><td class="num" id="LN283">283</td><td class="line">      <span class='comment'>/* now subtract cc and rd from r[m..n] */</span></td></tr>
<tr class="codeline" data-linenumber="284"><td class="num" id="LN284">284</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="285"><td class="num" id="LN285">285</td><td class="line">      r[n] = -<span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (r + m, r + m, n - m, cc);</td></tr>
<tr class="codeline" data-linenumber="286"><td class="num" id="LN286">286</td><td class="line">      r[n] -= <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (r + m, r + m, n - m, rd);</td></tr>
<tr class="codeline" data-linenumber="287"><td class="num" id="LN287">287</td><td class="line">      <span class='keyword'>if</span> (r[n] &amp; <span class='macro'>GMP_LIMB_HIGHBIT<span class='macro_popup'>((~ (mp_limb_t) 0) ^ ((~ (mp_limb_t) 0) &gt;&gt; 1))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="288"><td class="num" id="LN288">288</td><td class="line">	r[n] = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (r, r, n, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="289"><td class="num" id="LN289">289</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="290"><td class="num" id="LN290">290</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="291"><td class="num" id="LN291">291</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="292"><td class="num" id="LN292">292</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="293"><td class="num" id="LN293">293</td><td class="line"><span class='comment'>/* r &lt;- a+b mod 2^(n*GMP_NUMB_BITS)+1.</span></td></tr>
<tr class="codeline" data-linenumber="294"><td class="num" id="LN294">294</td><td class="line">   <span class='comment'>Assumes a and b are semi-normalized.</span></td></tr>
<tr class="codeline" data-linenumber="295"><td class="num" id="LN295">295</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="296"><td class="num" id="LN296">296</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="297"><td class="num" id="LN297">297</td><td class="line">mpn_fft_add_modF (mp_ptr r, mp_srcptr a, mp_srcptr b, mp_size_t n)</td></tr>
<tr class="codeline" data-linenumber="298"><td class="num" id="LN298">298</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="299"><td class="num" id="LN299">299</td><td class="line">  mp_limb_t c, x;</td></tr>
<tr class="codeline" data-linenumber="300"><td class="num" id="LN300">300</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="301"><td class="num" id="LN301">301</td><td class="line">  c = a[n] + b[n] + <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (r, a, b, n);</td></tr>
<tr class="codeline" data-linenumber="302"><td class="num" id="LN302">302</td><td class="line">  <span class='comment'>/* 0 &lt;= c &lt;= 3 */</span></td></tr>
<tr class="codeline" data-linenumber="303"><td class="num" id="LN303">303</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="304"><td class="num" id="LN304">304</td><td class="line"><span class='directive'>#if 1</span></td></tr>
<tr class="codeline" data-linenumber="305"><td class="num" id="LN305">305</td><td class="line">  <span class='comment'>/* GCC 4.1 outsmarts most expressions here, and generates a 50% branch.  The</span></td></tr>
<tr class="codeline" data-linenumber="306"><td class="num" id="LN306">306</td><td class="line">     <span class='comment'>result is slower code, of course.  But the following outsmarts GCC.  */</span></td></tr>
<tr class="codeline" data-linenumber="307"><td class="num" id="LN307">307</td><td class="line">  x = (c - 1) &amp; -(c != 0);</td></tr>
<tr class="codeline" data-linenumber="308"><td class="num" id="LN308">308</td><td class="line">  r[n] = c - x;</td></tr>
<tr class="codeline" data-linenumber="309"><td class="num" id="LN309">309</td><td class="line">  <span class='macro'>MPN_DECR_U (r, n + 1, x)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (x) &amp;&amp;<br> (x) == 0) { } else if (__builtin_constant_p (x) &amp;&amp; (<br>x) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top" ":\n"<br> "\t" "subq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t" ".L"<br> "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof(<br>mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "subq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "subq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (x)), "n" (<br>sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="310"><td class="num" id="LN310">310</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="311"><td class="num" id="LN311">311</td><td class="line"><span class='directive'>#if 0</span></td></tr>
<tr class="codeline" data-linenumber="312"><td class="num" id="LN312">312</td><td class="line">  <span class='keyword'>if</span> (c &gt; 1)</td></tr>
<tr class="codeline" data-linenumber="313"><td class="num" id="LN313">313</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="314"><td class="num" id="LN314">314</td><td class="line">      r[n] = 1;                       <span class='comment'>/* r[n] - c = 1 */</span></td></tr>
<tr class="codeline" data-linenumber="315"><td class="num" id="LN315">315</td><td class="line">      <span class='macro'>MPN_DECR_U (r, n + 1, c - 1)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (c - 1) &amp;&amp;<br> (c - 1) == 0) { } else if (__builtin_constant_p (c - 1) &amp;&amp;<br> (c - 1) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top"<br> ":\n" "\t" "subq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t"<br> ".L" "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof<br>(mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "subq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "subq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (c - 1)), "n"<br> (sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="316"><td class="num" id="LN316">316</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="317"><td class="num" id="LN317">317</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="318"><td class="num" id="LN318">318</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="319"><td class="num" id="LN319">319</td><td class="line">      r[n] = c;</td></tr>
<tr class="codeline" data-linenumber="320"><td class="num" id="LN320">320</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="321"><td class="num" id="LN321">321</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="322"><td class="num" id="LN322">322</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="323"><td class="num" id="LN323">323</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="324"><td class="num" id="LN324">324</td><td class="line"><span class='comment'>/* r &lt;- a-b mod 2^(n*GMP_NUMB_BITS)+1.</span></td></tr>
<tr class="codeline" data-linenumber="325"><td class="num" id="LN325">325</td><td class="line">   <span class='comment'>Assumes a and b are semi-normalized.</span></td></tr>
<tr class="codeline" data-linenumber="326"><td class="num" id="LN326">326</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="327"><td class="num" id="LN327">327</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="328"><td class="num" id="LN328">328</td><td class="line">mpn_fft_sub_modF (mp_ptr r, mp_srcptr a, mp_srcptr b, mp_size_t n)</td></tr>
<tr class="codeline" data-linenumber="329"><td class="num" id="LN329">329</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="330"><td class="num" id="LN330">330</td><td class="line">  mp_limb_t c, x;</td></tr>
<tr class="codeline" data-linenumber="331"><td class="num" id="LN331">331</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="332"><td class="num" id="LN332">332</td><td class="line">  c = a[n] - b[n] - <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (r, a, b, n);</td></tr>
<tr class="codeline" data-linenumber="333"><td class="num" id="LN333">333</td><td class="line">  <span class='comment'>/* -2 &lt;= c &lt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="334"><td class="num" id="LN334">334</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="335"><td class="num" id="LN335">335</td><td class="line"><span class='directive'>#if 1</span></td></tr>
<tr class="codeline" data-linenumber="336"><td class="num" id="LN336">336</td><td class="line">  <span class='comment'>/* GCC 4.1 outsmarts most expressions here, and generates a 50% branch.  The</span></td></tr>
<tr class="codeline" data-linenumber="337"><td class="num" id="LN337">337</td><td class="line">     <span class='comment'>result is slower code, of course.  But the following outsmarts GCC.  */</span></td></tr>
<tr class="codeline" data-linenumber="338"><td class="num" id="LN338">338</td><td class="line">  x = (-c) &amp; -((c &amp; <span class='macro'>GMP_LIMB_HIGHBIT<span class='macro_popup'>((~ (mp_limb_t) 0) ^ ((~ (mp_limb_t) 0) &gt;&gt; 1))</span></span>) != 0);</td></tr>
<tr class="codeline" data-linenumber="339"><td class="num" id="LN339">339</td><td class="line">  r[n] = x + c;</td></tr>
<tr class="codeline" data-linenumber="340"><td class="num" id="LN340">340</td><td class="line">  <span class='macro'>MPN_INCR_U (r, n + 1, x)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (x) &amp;&amp;<br> (x) == 0) { } else if (__builtin_constant_p (x) &amp;&amp; (<br>x) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top" ":\n"<br> "\t" "addq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t" ".L"<br> "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof(<br>mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "addq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "addq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (x)), "n" (<br>sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="341"><td class="num" id="LN341">341</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="342"><td class="num" id="LN342">342</td><td class="line"><span class='directive'>#if 0</span></td></tr>
<tr class="codeline" data-linenumber="343"><td class="num" id="LN343">343</td><td class="line">  <span class='keyword'>if</span> ((c &amp; <span class='macro'>GMP_LIMB_HIGHBIT<span class='macro_popup'>((~ (mp_limb_t) 0) ^ ((~ (mp_limb_t) 0) &gt;&gt; 1))</span></span>) != 0)</td></tr>
<tr class="codeline" data-linenumber="344"><td class="num" id="LN344">344</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="345"><td class="num" id="LN345">345</td><td class="line">      r[n] = 0;</td></tr>
<tr class="codeline" data-linenumber="346"><td class="num" id="LN346">346</td><td class="line">      <span class='macro'>MPN_INCR_U (r, n + 1, -c)<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (-c) &amp;&amp;<br> (-c) == 0) { } else if (__builtin_constant_p (-c) &amp;&amp;<br> (-c) == 1) { __asm__ __volatile__ ("\n" ".L" "asm_%=_" "top"<br> ":\n" "\t" "addq" "\t$1, (%0)\n" "\tlea\t%c2(%0), %0\n" "\tjc\t"<br> ".L" "asm_%=_" "top" : "=r" (__ptr_dummy) : "0" (r), "n" (sizeof<br>(mp_limb_t)) : "memory"); } else { __asm__ __volatile__ ( "addq"<br> "\t%2, (%0)\n" "\tjnc\t" ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_"<br> "top" ":\n" "\t" "addq" "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n"<br> "\tjc\t" ".L" "asm_%=_" "top" "\n" ".L" "asm_%=_" "done" ":\n"<br> : "=r" (__ptr_dummy) : "0" (r), "re" ((mp_limb_t) (-c)), "n"<br> (sizeof(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="347"><td class="num" id="LN347">347</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="348"><td class="num" id="LN348">348</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="349"><td class="num" id="LN349">349</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="350"><td class="num" id="LN350">350</td><td class="line">      r[n] = c;</td></tr>
<tr class="codeline" data-linenumber="351"><td class="num" id="LN351">351</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="352"><td class="num" id="LN352">352</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="353"><td class="num" id="LN353">353</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="354"><td class="num" id="LN354">354</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="355"><td class="num" id="LN355">355</td><td class="line"><span class='comment'>/* input: A[0] ... A[inc*(K-1)] are residues mod 2^N+1 where</span></td></tr>
<tr class="codeline" data-linenumber="356"><td class="num" id="LN356">356</td><td class="line">	  <span class='comment'>N=n*GMP_NUMB_BITS, and 2^omega is a primitive root mod 2^N+1</span></td></tr>
<tr class="codeline" data-linenumber="357"><td class="num" id="LN357">357</td><td class="line">   <span class='comment'>output: A[inc*l[k][i]] &lt;- \sum (2^omega)^(ij) A[inc*j] mod 2^N+1 */</span></td></tr>
<tr class="codeline" data-linenumber="358"><td class="num" id="LN358">358</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="359"><td class="num" id="LN359">359</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="360"><td class="num" id="LN360">360</td><td class="line">mpn_fft_fft (mp_ptr *Ap, mp_size_t K, <span class='keyword'>int</span> **ll,</td></tr>
<tr class="codeline" data-linenumber="361"><td class="num" id="LN361">361</td><td class="line">	     mp_size_t omega, mp_size_t n, mp_size_t inc, mp_ptr tp)</td></tr>
<tr class="codeline" data-linenumber="362"><td class="num" id="LN362">362</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="363"><td class="num" id="LN363">363</td><td class="line">  <span class='keyword'>if</span> (K == 2)</td></tr>
<tr class="codeline" data-linenumber="364"><td class="num" id="LN364">364</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="365"><td class="num" id="LN365">365</td><td class="line">      mp_limb_t cy;</td></tr>
<tr class="codeline" data-linenumber="366"><td class="num" id="LN366">366</td><td class="line"><span class='directive'>#if HAVE_NATIVE_mpn_add_n_sub_n</span></td></tr>
<tr class="codeline" data-linenumber="367"><td class="num" id="LN367">367</td><td class="line">      cy = <span class='macro'>mpn_add_n_sub_n<span class='macro_popup'>__gmpn_add_n_sub_n</span></span> (Ap[0], Ap[inc], Ap[0], Ap[inc], n + 1) &amp; 1;</td></tr>
<tr class="codeline" data-linenumber="368"><td class="num" id="LN368">368</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="369"><td class="num" id="LN369">369</td><td class="line">      <span class='macro'>MPN_COPY (tp, Ap[0], n + 1)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (tp, Ap[0], n + 1); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="370"><td class="num" id="LN370">370</td><td class="line">      <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (Ap[0], Ap[0], Ap[inc], n + 1);</td></tr>
<tr class="codeline" data-linenumber="371"><td class="num" id="LN371">371</td><td class="line">      cy = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (Ap[inc], tp, Ap[inc], n + 1);</td></tr>
<tr class="codeline" data-linenumber="372"><td class="num" id="LN372">372</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="373"><td class="num" id="LN373">373</td><td class="line">      <span class='keyword'>if</span> (Ap[0][n] &gt; 1) <span class='comment'>/* can be 2 or 3 */</span></td></tr>
<tr class="codeline" data-linenumber="374"><td class="num" id="LN374">374</td><td class="line">	Ap[0][n] = 1 - <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (Ap[0], Ap[0], n, Ap[0][n] - 1);</td></tr>
<tr class="codeline" data-linenumber="375"><td class="num" id="LN375">375</td><td class="line">      <span class='keyword'>if</span> (cy) <span class='comment'>/* Ap[inc][n] can be -1 or -2 */</span></td></tr>
<tr class="codeline" data-linenumber="376"><td class="num" id="LN376">376</td><td class="line">	Ap[inc][n] = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (Ap[inc], Ap[inc], n, ~Ap[inc][n] + 1);</td></tr>
<tr class="codeline" data-linenumber="377"><td class="num" id="LN377">377</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="378"><td class="num" id="LN378">378</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="379"><td class="num" id="LN379">379</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="380"><td class="num" id="LN380">380</td><td class="line">      mp_size_t j, K2 = K &gt;&gt; 1;</td></tr>
<tr class="codeline" data-linenumber="381"><td class="num" id="LN381">381</td><td class="line">      <span class='keyword'>int</span> *lk = *ll;</td></tr>
<tr class="codeline" data-linenumber="382"><td class="num" id="LN382">382</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="383"><td class="num" id="LN383">383</td><td class="line">      mpn_fft_fft (Ap,     K2, ll-1, 2 * omega, n, inc * 2, tp);</td></tr>
<tr class="codeline" data-linenumber="384"><td class="num" id="LN384">384</td><td class="line">      mpn_fft_fft (Ap+inc, K2, ll-1, 2 * omega, n, inc * 2, tp);</td></tr>
<tr class="codeline" data-linenumber="385"><td class="num" id="LN385">385</td><td class="line">      <span class='comment'>/* A[2*j*inc]   &lt;- A[2*j*inc] + omega^l[k][2*j*inc] A[(2j+1)inc]</span></td></tr>
<tr class="codeline" data-linenumber="386"><td class="num" id="LN386">386</td><td class="line">	 <span class='comment'>A[(2j+1)inc] &lt;- A[2*j*inc] + omega^l[k][(2j+1)inc] A[(2j+1)inc] */</span></td></tr>
<tr class="codeline" data-linenumber="387"><td class="num" id="LN387">387</td><td class="line">      <span class='keyword'>for</span> (j = 0; j &lt; K2; j++, lk += 2, Ap += 2 * inc)</td></tr>
<tr class="codeline" data-linenumber="388"><td class="num" id="LN388">388</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="389"><td class="num" id="LN389">389</td><td class="line">	  <span class='comment'>/* Ap[inc] &lt;- Ap[0] + Ap[inc] * 2^(lk[1] * omega)</span></td></tr>
<tr class="codeline" data-linenumber="390"><td class="num" id="LN390">390</td><td class="line">	     <span class='comment'>Ap[0]   &lt;- Ap[0] + Ap[inc] * 2^(lk[0] * omega) */</span></td></tr>
<tr class="codeline" data-linenumber="391"><td class="num" id="LN391">391</td><td class="line">	  mpn_fft_mul_2exp_modF (tp, Ap[inc], lk[0] * omega, n);</td></tr>
<tr class="codeline" data-linenumber="392"><td class="num" id="LN392">392</td><td class="line">	  mpn_fft_sub_modF (Ap[inc], Ap[0], tp, n);</td></tr>
<tr class="codeline" data-linenumber="393"><td class="num" id="LN393">393</td><td class="line">	  mpn_fft_add_modF (Ap[0],   Ap[0], tp, n);</td></tr>
<tr class="codeline" data-linenumber="394"><td class="num" id="LN394">394</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="395"><td class="num" id="LN395">395</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="396"><td class="num" id="LN396">396</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="397"><td class="num" id="LN397">397</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="398"><td class="num" id="LN398">398</td><td class="line"><span class='comment'>/* input: A[0] ... A[inc*(K-1)] are residues mod 2^N+1 where</span></td></tr>
<tr class="codeline" data-linenumber="399"><td class="num" id="LN399">399</td><td class="line">	  <span class='comment'>N=n*GMP_NUMB_BITS, and 2^omega is a primitive root mod 2^N+1</span></td></tr>
<tr class="codeline" data-linenumber="400"><td class="num" id="LN400">400</td><td class="line">   <span class='comment'>output: A[inc*l[k][i]] &lt;- \sum (2^omega)^(ij) A[inc*j] mod 2^N+1</span></td></tr>
<tr class="codeline" data-linenumber="401"><td class="num" id="LN401">401</td><td class="line">   <span class='comment'>tp must have space for 2*(n+1) limbs.</span></td></tr>
<tr class="codeline" data-linenumber="402"><td class="num" id="LN402">402</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="403"><td class="num" id="LN403">403</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="404"><td class="num" id="LN404">404</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="405"><td class="num" id="LN405">405</td><td class="line"><span class='comment'>/* Given ap[0..n] with ap[n]&lt;=1, reduce it modulo 2^(n*GMP_NUMB_BITS)+1,</span></td></tr>
<tr class="codeline" data-linenumber="406"><td class="num" id="LN406">406</td><td class="line">   <span class='comment'>by subtracting that modulus if necessary.</span></td></tr>
<tr class="codeline" data-linenumber="407"><td class="num" id="LN407">407</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="408"><td class="num" id="LN408">408</td><td class="line">   <span class='comment'>If ap[0..n] is exactly 2^(n*GMP_NUMB_BITS) then mpn_sub_1 produces a</span></td></tr>
<tr class="codeline" data-linenumber="409"><td class="num" id="LN409">409</td><td class="line">   <span class='comment'>borrow and the limbs must be zeroed out again.  This will occur very</span></td></tr>
<tr class="codeline" data-linenumber="410"><td class="num" id="LN410">410</td><td class="line">   <span class='comment'>infrequently.  */</span></td></tr>
<tr class="codeline" data-linenumber="411"><td class="num" id="LN411">411</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="412"><td class="num" id="LN412">412</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="413"><td class="num" id="LN413">413</td><td class="line">mpn_fft_normalize (mp_ptr ap, mp_size_t n)</td></tr>
<tr class="codeline" data-linenumber="414"><td class="num" id="LN414">414</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="415"><td class="num" id="LN415">415</td><td class="line">  <span class='keyword'>if</span> (ap[n] != 0)</td></tr>
<tr class="codeline" data-linenumber="416"><td class="num" id="LN416">416</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="417"><td class="num" id="LN417">417</td><td class="line">      <span class='macro'>MPN_DECR_U (ap, n + 1, CNST_LIMB(1))<span class='macro_popup'>do { mp_ptr __ptr_dummy; if (__builtin_constant_p (((mp_limb_t<br>) 1L)) &amp;&amp; (((mp_limb_t) 1L)) == 0) { } else if (__builtin_constant_p<br> (((mp_limb_t) 1L)) &amp;&amp; (((mp_limb_t) 1L)) == 1) { __asm__<br> __volatile__ ("\n" ".L" "asm_%=_" "top" ":\n" "\t" "subq" "\t$1, (%0)\n"<br> "\tlea\t%c2(%0), %0\n" "\tjc\t" ".L" "asm_%=_" "top" : "=r" (<br>__ptr_dummy) : "0" (ap), "n" (sizeof(mp_limb_t)) : "memory");<br> } else { __asm__ __volatile__ ( "subq" "\t%2, (%0)\n" "\tjnc\t"<br> ".L" "asm_%=_" "done" "\n" ".L" "asm_%=_" "top" ":\n" "\t" "subq"<br> "\t$1, %c3(%0)\n" "\tlea\t%c3(%0), %0\n" "\tjc\t" ".L" "asm_%=_"<br> "top" "\n" ".L" "asm_%=_" "done" ":\n" : "=r" (__ptr_dummy) :<br> "0" (ap), "re" ((mp_limb_t) (((mp_limb_t) 1L))), "n" (sizeof<br>(mp_limb_t)) : "memory"); } } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="418"><td class="num" id="LN418">418</td><td class="line">      <span class='keyword'>if</span> (ap[n] == 0)</td></tr>
<tr class="codeline" data-linenumber="419"><td class="num" id="LN419">419</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="420"><td class="num" id="LN420">420</td><td class="line">	  <span class='comment'>/* This happens with very low probability; we have yet to trigger it,</span></td></tr>
<tr class="codeline" data-linenumber="421"><td class="num" id="LN421">421</td><td class="line">	     <span class='comment'>and thereby make sure this code is correct.  */</span></td></tr>
<tr class="codeline" data-linenumber="422"><td class="num" id="LN422">422</td><td class="line">	  <span class='macro'>MPN_ZERO (ap, n)<span class='macro_popup'>do { do {} while (0); if ((n) != 0) do { mp_ptr __dst = (ap);<br> mp_size_t __n = (n); do {} while (0); do *__dst++ = (((mp_limb_t<br>) 0L)); while (--__n); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="423"><td class="num" id="LN423">423</td><td class="line">	  ap[n] = 1;</td></tr>
<tr class="codeline" data-linenumber="424"><td class="num" id="LN424">424</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="425"><td class="num" id="LN425">425</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="426"><td class="num" id="LN426">426</td><td class="line">	ap[n] = 0;</td></tr>
<tr class="codeline" data-linenumber="427"><td class="num" id="LN427">427</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="428"><td class="num" id="LN428">428</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="429"><td class="num" id="LN429">429</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="430"><td class="num" id="LN430">430</td><td class="line"><span class='comment'>/* a[i] &lt;- a[i]*b[i] mod 2^(n*GMP_NUMB_BITS)+1 for 0 &lt;= i &lt; K */</span></td></tr>
<tr class="codeline" data-linenumber="431"><td class="num" id="LN431">431</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="432"><td class="num" id="LN432">432</td><td class="line">mpn_fft_mul_modF_K (mp_ptr *ap, mp_ptr *bp, mp_size_t n, mp_size_t K)</td></tr>
<tr class="codeline" data-linenumber="433"><td class="num" id="LN433">433</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="434"><td class="num" id="LN434">434</td><td class="line">  <span class='keyword'>int</span> i;</td></tr>
<tr class="codeline" data-linenumber="435"><td class="num" id="LN435">435</td><td class="line">  <span class='keyword'>int</span> sqr = (ap == bp);</td></tr>
<tr class="codeline" data-linenumber="436"><td class="num" id="LN436">436</td><td class="line">  <span class='macro'>TMP_DECL<span class='macro_popup'>struct tmp_reentrant_t *__tmp_marker</span></span>;</td></tr>
<tr class="codeline" data-linenumber="437"><td class="num" id="LN437">437</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="438"><td class="num" id="LN438">438</td><td class="line">  <span class='macro'>TMP_MARK<span class='macro_popup'>__tmp_marker = 0</span></span>;</td></tr>
<tr class="codeline" data-linenumber="439"><td class="num" id="LN439">439</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="440"><td class="num" id="LN440">440</td><td class="line">  <span class='keyword'>if</span> (n &gt;= (sqr ? <span class='macro'>SQR_FFT_MODF_THRESHOLD<span class='macro_popup'>570</span></span> : <span class='macro'>MUL_FFT_MODF_THRESHOLD<span class='macro_popup'>654</span></span>))</td></tr>
<tr class="codeline" data-linenumber="441"><td class="num" id="LN441">441</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="442"><td class="num" id="LN442">442</td><td class="line">      mp_size_t K2, nprime2, Nprime2, M2, maxLK, l, Mp2;</td></tr>
<tr class="codeline" data-linenumber="443"><td class="num" id="LN443">443</td><td class="line">      <span class='keyword'>int</span> k;</td></tr>
<tr class="codeline" data-linenumber="444"><td class="num" id="LN444">444</td><td class="line">      <span class='keyword'>int</span> **fft_l, *tmp;</td></tr>
<tr class="codeline" data-linenumber="445"><td class="num" id="LN445">445</td><td class="line">      mp_ptr *Ap, *Bp, A, B, T;</td></tr>
<tr class="codeline" data-linenumber="446"><td class="num" id="LN446">446</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="447"><td class="num" id="LN447">447</td><td class="line">      k = <span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (n, sqr);</td></tr>
<tr class="codeline" data-linenumber="448"><td class="num" id="LN448">448</td><td class="line">      K2 = (mp_size_t) 1 &lt;&lt; k;</td></tr>
<tr class="codeline" data-linenumber="449"><td class="num" id="LN449">449</td><td class="line">      <span class='macro'>ASSERT_ALWAYS((n &amp; (K2 - 1)) == 0)<span class='macro_popup'>do { if (__builtin_expect ((!((n &amp; (K2 - 1)) == 0)) != 0,<br> 0)) __gmp_assert_fail ("mul_fft.c", 449, "(n &amp; (K2 - 1)) == 0"<br>); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="450"><td class="num" id="LN450">450</td><td class="line">      maxLK = (K2 &gt; <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>) ? K2 : <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="451"><td class="num" id="LN451">451</td><td class="line">      M2 = n * <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span> &gt;&gt; k;</td></tr>
<tr class="codeline" data-linenumber="452"><td class="num" id="LN452">452</td><td class="line">      l = n &gt;&gt; k;</td></tr>
<tr class="codeline" data-linenumber="453"><td class="num" id="LN453">453</td><td class="line">      Nprime2 = ((2 * M2 + k + 2 + maxLK) / maxLK) * maxLK;</td></tr>
<tr class="codeline" data-linenumber="454"><td class="num" id="LN454">454</td><td class="line">      <span class='comment'>/* Nprime2 = ceil((2*M2+k+3)/maxLK)*maxLK*/</span></td></tr>
<tr class="codeline" data-linenumber="455"><td class="num" id="LN455">455</td><td class="line">      nprime2 = Nprime2 / <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="456"><td class="num" id="LN456">456</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="457"><td class="num" id="LN457">457</td><td class="line">      <span class='comment'>/* we should ensure that nprime2 is a multiple of the next K */</span></td></tr>
<tr class="codeline" data-linenumber="458"><td class="num" id="LN458">458</td><td class="line">      <span class='keyword'>if</span> (nprime2 &gt;= (sqr ? <span class='macro'>SQR_FFT_MODF_THRESHOLD<span class='macro_popup'>570</span></span> : <span class='macro'>MUL_FFT_MODF_THRESHOLD<span class='macro_popup'>654</span></span>))</td></tr>
<tr class="codeline" data-linenumber="459"><td class="num" id="LN459">459</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="460"><td class="num" id="LN460">460</td><td class="line">	  mp_size_t K3;</td></tr>
<tr class="codeline" data-linenumber="461"><td class="num" id="LN461">461</td><td class="line">	  <span class='keyword'>for</span> (;;)</td></tr>
<tr class="codeline" data-linenumber="462"><td class="num" id="LN462">462</td><td class="line">	    {</td></tr>
<tr class="codeline" data-linenumber="463"><td class="num" id="LN463">463</td><td class="line">	      K3 = (mp_size_t) 1 &lt;&lt; <span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (nprime2, sqr);</td></tr>
<tr class="codeline" data-linenumber="464"><td class="num" id="LN464">464</td><td class="line">	      <span class='keyword'>if</span> ((nprime2 &amp; (K3 - 1)) == 0)</td></tr>
<tr class="codeline" data-linenumber="465"><td class="num" id="LN465">465</td><td class="line">		<span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="466"><td class="num" id="LN466">466</td><td class="line">	      nprime2 = (nprime2 + K3 - 1) &amp; -K3;</td></tr>
<tr class="codeline" data-linenumber="467"><td class="num" id="LN467">467</td><td class="line">	      Nprime2 = nprime2 * <span class='macro'>GMP_LIMB_BITS<span class='macro_popup'>64</span></span>;</td></tr>
<tr class="codeline" data-linenumber="468"><td class="num" id="LN468">468</td><td class="line">	      <span class='comment'>/* warning: since nprime2 changed, K3 may change too! */</span></td></tr>
<tr class="codeline" data-linenumber="469"><td class="num" id="LN469">469</td><td class="line">	    }</td></tr>
<tr class="codeline" data-linenumber="470"><td class="num" id="LN470">470</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="471"><td class="num" id="LN471">471</td><td class="line">      <span class='macro'>ASSERT_ALWAYS(nprime2 &lt; n)<span class='macro_popup'>do { if (__builtin_expect ((!(nprime2 &lt; n)) != 0, 0)) __gmp_assert_fail<br> ("mul_fft.c", 471, "nprime2 &lt; n"); } while (0)</span></span>; <span class='comment'>/* otherwise we'll loop */</span></td></tr>
<tr class="codeline" data-linenumber="472"><td class="num" id="LN472">472</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="473"><td class="num" id="LN473">473</td><td class="line">      Mp2 = Nprime2 &gt;&gt; k;</td></tr>
<tr class="codeline" data-linenumber="474"><td class="num" id="LN474">474</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="475"><td class="num" id="LN475">475</td><td class="line">      Ap = <span class='macro'>TMP_BALLOC_MP_PTRS (K2)<span class='macro_popup'>((mp_ptr *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (K2<br>) * sizeof (mp_ptr)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="476"><td class="num" id="LN476">476</td><td class="line">      Bp = <span class='macro'>TMP_BALLOC_MP_PTRS (K2)<span class='macro_popup'>((mp_ptr *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (K2<br>) * sizeof (mp_ptr)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="477"><td class="num" id="LN477">477</td><td class="line">      A = <span class='macro'>TMP_BALLOC_LIMBS (2 * (nprime2 + 1) &lt;&lt; k)<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>2 * (nprime2 + 1) &lt;&lt; k) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="478"><td class="num" id="LN478">478</td><td class="line">      T = <span class='macro'>TMP_BALLOC_LIMBS (2 * (nprime2 + 1))<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>2 * (nprime2 + 1)) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="479"><td class="num" id="LN479">479</td><td class="line">      B = A + ((nprime2 + 1) &lt;&lt; k);</td></tr>
<tr class="codeline" data-linenumber="480"><td class="num" id="LN480">480</td><td class="line">      fft_l = <span class='macro'>TMP_BALLOC_TYPE (k + 1, <span class='keyword'>int</span> *)<span class='macro_popup'>((int * *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (k +<br> 1) * sizeof (int *)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="481"><td class="num" id="LN481">481</td><td class="line">      tmp = <span class='macro'>TMP_BALLOC_TYPE ((size_t) 2 &lt;&lt; k, <span class='keyword'>int</span>)<span class='macro_popup'>((int *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, ((size_t<br>) 2 &lt;&lt; k) * sizeof (int)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="482"><td class="num" id="LN482">482</td><td class="line">      <span class='keyword'>for</span> (i = 0; i &lt;= k; i++)</td></tr>
<tr class="codeline" data-linenumber="483"><td class="num" id="LN483">483</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="484"><td class="num" id="LN484">484</td><td class="line">	  fft_l[i] = tmp;</td></tr>
<tr class="codeline" data-linenumber="485"><td class="num" id="LN485">485</td><td class="line">	  tmp += (mp_size_t) 1 &lt;&lt; i;</td></tr>
<tr class="codeline" data-linenumber="486"><td class="num" id="LN486">486</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="487"><td class="num" id="LN487">487</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="488"><td class="num" id="LN488">488</td><td class="line">      mpn_fft_initl (fft_l, k);</td></tr>
<tr class="codeline" data-linenumber="489"><td class="num" id="LN489">489</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="490"><td class="num" id="LN490">490</td><td class="line">      TRACE (printf (<span class='string_literal'>"recurse: %ldx%ld limbs -&gt; %ld times %ldx%ld (%1.2f)\n"</span>, n,</td></tr>
<tr class="codeline" data-linenumber="491"><td class="num" id="LN491">491</td><td class="line">		    n, K2, nprime2, nprime2, 2.0*(<span class='keyword'>double</span>)n/nprime2/K2));</td></tr>
<tr class="codeline" data-linenumber="492"><td class="num" id="LN492">492</td><td class="line">      <span class='keyword'>for</span> (i = 0; i &lt; K; i++, ap++, bp++)</td></tr>
<tr class="codeline" data-linenumber="493"><td class="num" id="LN493">493</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="494"><td class="num" id="LN494">494</td><td class="line">	  mp_limb_t cy;</td></tr>
<tr class="codeline" data-linenumber="495"><td class="num" id="LN495">495</td><td class="line">	  mpn_fft_normalize (*ap, n);</td></tr>
<tr class="codeline" data-linenumber="496"><td class="num" id="LN496">496</td><td class="line">	  <span class='keyword'>if</span> (!sqr)</td></tr>
<tr class="codeline" data-linenumber="497"><td class="num" id="LN497">497</td><td class="line">	    mpn_fft_normalize (*bp, n);</td></tr>
<tr class="codeline" data-linenumber="498"><td class="num" id="LN498">498</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="499"><td class="num" id="LN499">499</td><td class="line">	  mpn_mul_fft_decompose (A, Ap, K2, nprime2, *ap, (l &lt;&lt; k) + 1, l, Mp2, T);</td></tr>
<tr class="codeline" data-linenumber="500"><td class="num" id="LN500">500</td><td class="line">	  <span class='keyword'>if</span> (!sqr)</td></tr>
<tr class="codeline" data-linenumber="501"><td class="num" id="LN501">501</td><td class="line">	    mpn_mul_fft_decompose (B, Bp, K2, nprime2, *bp, (l &lt;&lt; k) + 1, l, Mp2, T);</td></tr>
<tr class="codeline" data-linenumber="502"><td class="num" id="LN502">502</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="503"><td class="num" id="LN503">503</td><td class="line">	  cy = mpn_mul_fft_internal (*ap, n, k, Ap, Bp, A, B, nprime2,</td></tr>
<tr class="codeline" data-linenumber="504"><td class="num" id="LN504">504</td><td class="line">				     l, Mp2, fft_l, T, sqr);</td></tr>
<tr class="codeline" data-linenumber="505"><td class="num" id="LN505">505</td><td class="line">	  (*ap)[n] = cy;</td></tr>
<tr class="codeline" data-linenumber="506"><td class="num" id="LN506">506</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="507"><td class="num" id="LN507">507</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="508"><td class="num" id="LN508">508</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="509"><td class="num" id="LN509">509</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="510"><td class="num" id="LN510">510</td><td class="line">      mp_ptr a, b, tp, tpn;</td></tr>
<tr class="codeline" data-linenumber="511"><td class="num" id="LN511">511</td><td class="line">      mp_limb_t cc;</td></tr>
<tr class="codeline" data-linenumber="512"><td class="num" id="LN512">512</td><td class="line">      mp_size_t n2 = 2 * n;</td></tr>
<tr class="codeline" data-linenumber="513"><td class="num" id="LN513">513</td><td class="line">      tp = <span class='macro'>TMP_BALLOC_LIMBS (n2)<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>n2) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="514"><td class="num" id="LN514">514</td><td class="line">      tpn = tp + n;</td></tr>
<tr class="codeline" data-linenumber="515"><td class="num" id="LN515">515</td><td class="line">      TRACE (printf (<span class='string_literal'>"  mpn_mul_n %ld of %ld limbs\n"</span>, K, n));</td></tr>
<tr class="codeline" data-linenumber="516"><td class="num" id="LN516">516</td><td class="line">      <span class='keyword'>for</span> (i = 0; i &lt; K; i++)</td></tr>
<tr class="codeline" data-linenumber="517"><td class="num" id="LN517">517</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="518"><td class="num" id="LN518">518</td><td class="line">	  a = *ap++;</td></tr>
<tr class="codeline" data-linenumber="519"><td class="num" id="LN519">519</td><td class="line">	  b = *bp++;</td></tr>
<tr class="codeline" data-linenumber="520"><td class="num" id="LN520">520</td><td class="line">	  <span class='keyword'>if</span> (sqr)</td></tr>
<tr class="codeline" data-linenumber="521"><td class="num" id="LN521">521</td><td class="line">	    <span class='macro'>mpn_sqr<span class='macro_popup'>__gmpn_sqr</span></span> (tp, a, n);</td></tr>
<tr class="codeline" data-linenumber="522"><td class="num" id="LN522">522</td><td class="line">	  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="523"><td class="num" id="LN523">523</td><td class="line">	    <span class='macro'>mpn_mul_n<span class='macro_popup'>__gmpn_mul_n</span></span> (tp, b, a, n);</td></tr>
<tr class="codeline" data-linenumber="524"><td class="num" id="LN524">524</td><td class="line">	  <span class='keyword'>if</span> (a[n] != 0)</td></tr>
<tr class="codeline" data-linenumber="525"><td class="num" id="LN525">525</td><td class="line">	    cc = <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (tpn, tpn, b, n);</td></tr>
<tr class="codeline" data-linenumber="526"><td class="num" id="LN526">526</td><td class="line">	  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="527"><td class="num" id="LN527">527</td><td class="line">	    cc = 0;</td></tr>
<tr class="codeline" data-linenumber="528"><td class="num" id="LN528">528</td><td class="line">	  <span class='keyword'>if</span> (b[n] != 0)</td></tr>
<tr class="codeline" data-linenumber="529"><td class="num" id="LN529">529</td><td class="line">	    cc += <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (tpn, tpn, a, n) + a[n];</td></tr>
<tr class="codeline" data-linenumber="530"><td class="num" id="LN530">530</td><td class="line">	  <span class='keyword'>if</span> (cc != 0)</td></tr>
<tr class="codeline" data-linenumber="531"><td class="num" id="LN531">531</td><td class="line">	    {</td></tr>
<tr class="codeline" data-linenumber="532"><td class="num" id="LN532">532</td><td class="line">	      <span class='comment'>/* FIXME: use MPN_INCR_U here, since carry is not expected.  */</span></td></tr>
<tr class="codeline" data-linenumber="533"><td class="num" id="LN533">533</td><td class="line">	      cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (tp, tp, n2, cc);</td></tr>
<tr class="codeline" data-linenumber="534"><td class="num" id="LN534">534</td><td class="line">	      <span class='macro'>ASSERT (cc == 0)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="535"><td class="num" id="LN535">535</td><td class="line">	    }</td></tr>
<tr class="codeline" data-linenumber="536"><td class="num" id="LN536">536</td><td class="line">	  a[n] = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (a, tp, tpn, n) &amp;&amp; <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (a, a, n, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="537"><td class="num" id="LN537">537</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="538"><td class="num" id="LN538">538</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="539"><td class="num" id="LN539">539</td><td class="line">  <span class='macro'>TMP_FREE<span class='macro_popup'>do { if (__builtin_expect ((__tmp_marker != 0) != 0, 0)) __gmp_tmp_reentrant_free<br> (__tmp_marker); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="540"><td class="num" id="LN540">540</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="541"><td class="num" id="LN541">541</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="542"><td class="num" id="LN542">542</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="543"><td class="num" id="LN543">543</td><td class="line"><span class='comment'>/* input: A^[l[k][0]] A^[l[k][1]] ... A^[l[k][K-1]]</span></td></tr>
<tr class="codeline" data-linenumber="544"><td class="num" id="LN544">544</td><td class="line">   <span class='comment'>output: K*A[0] K*A[K-1] ... K*A[1].</span></td></tr>
<tr class="codeline" data-linenumber="545"><td class="num" id="LN545">545</td><td class="line">   <span class='comment'>Assumes the Ap[] are pseudo-normalized, i.e. 0 &lt;= Ap[][n] &lt;= 1.</span></td></tr>
<tr class="codeline" data-linenumber="546"><td class="num" id="LN546">546</td><td class="line">   <span class='comment'>This condition is also fulfilled at exit.</span></td></tr>
<tr class="codeline" data-linenumber="547"><td class="num" id="LN547">547</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="548"><td class="num" id="LN548">548</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="549"><td class="num" id="LN549">549</td><td class="line">mpn_fft_fftinv (mp_ptr *Ap, mp_size_t K, mp_size_t omega, mp_size_t n, mp_ptr tp)</td></tr>
<tr class="codeline" data-linenumber="550"><td class="num" id="LN550">550</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="551"><td class="num" id="LN551">551</td><td class="line">  <span class='keyword'>if</span> (K == 2)</td></tr>
<tr class="codeline" data-linenumber="552"><td class="num" id="LN552">552</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="553"><td class="num" id="LN553">553</td><td class="line">      mp_limb_t cy;</td></tr>
<tr class="codeline" data-linenumber="554"><td class="num" id="LN554">554</td><td class="line"><span class='directive'>#if HAVE_NATIVE_mpn_add_n_sub_n</span></td></tr>
<tr class="codeline" data-linenumber="555"><td class="num" id="LN555">555</td><td class="line">      cy = <span class='macro'>mpn_add_n_sub_n<span class='macro_popup'>__gmpn_add_n_sub_n</span></span> (Ap[0], Ap[1], Ap[0], Ap[1], n + 1) &amp; 1;</td></tr>
<tr class="codeline" data-linenumber="556"><td class="num" id="LN556">556</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="557"><td class="num" id="LN557">557</td><td class="line">      <span class='macro'>MPN_COPY (tp, Ap[0], n + 1)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (tp, Ap[0], n + 1); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="558"><td class="num" id="LN558">558</td><td class="line">      <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (Ap[0], Ap[0], Ap[1], n + 1);</td></tr>
<tr class="codeline" data-linenumber="559"><td class="num" id="LN559">559</td><td class="line">      cy = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (Ap[1], tp, Ap[1], n + 1);</td></tr>
<tr class="codeline" data-linenumber="560"><td class="num" id="LN560">560</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="561"><td class="num" id="LN561">561</td><td class="line">      <span class='keyword'>if</span> (Ap[0][n] &gt; 1) <span class='comment'>/* can be 2 or 3 */</span></td></tr>
<tr class="codeline" data-linenumber="562"><td class="num" id="LN562">562</td><td class="line">	Ap[0][n] = 1 - <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (Ap[0], Ap[0], n, Ap[0][n] - 1);</td></tr>
<tr class="codeline" data-linenumber="563"><td class="num" id="LN563">563</td><td class="line">      <span class='keyword'>if</span> (cy) <span class='comment'>/* Ap[1][n] can be -1 or -2 */</span></td></tr>
<tr class="codeline" data-linenumber="564"><td class="num" id="LN564">564</td><td class="line">	Ap[1][n] = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (Ap[1], Ap[1], n, ~Ap[1][n] + 1);</td></tr>
<tr class="codeline" data-linenumber="565"><td class="num" id="LN565">565</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="566"><td class="num" id="LN566">566</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="567"><td class="num" id="LN567">567</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="568"><td class="num" id="LN568">568</td><td class="line">      mp_size_t j, K2 = K &gt;&gt; 1;</td></tr>
<tr class="codeline" data-linenumber="569"><td class="num" id="LN569">569</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="570"><td class="num" id="LN570">570</td><td class="line">      mpn_fft_fftinv (Ap,      K2, 2 * omega, n, tp);</td></tr>
<tr class="codeline" data-linenumber="571"><td class="num" id="LN571">571</td><td class="line">      mpn_fft_fftinv (Ap + K2, K2, 2 * omega, n, tp);</td></tr>
<tr class="codeline" data-linenumber="572"><td class="num" id="LN572">572</td><td class="line">      <span class='comment'>/* A[j]     &lt;- A[j] + omega^j A[j+K/2]</span></td></tr>
<tr class="codeline" data-linenumber="573"><td class="num" id="LN573">573</td><td class="line">	 <span class='comment'>A[j+K/2] &lt;- A[j] + omega^(j+K/2) A[j+K/2] */</span></td></tr>
<tr class="codeline" data-linenumber="574"><td class="num" id="LN574">574</td><td class="line">      <span class='keyword'>for</span> (j = 0; j &lt; K2; j++, Ap++)</td></tr>
<tr class="codeline" data-linenumber="575"><td class="num" id="LN575">575</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="576"><td class="num" id="LN576">576</td><td class="line">	  <span class='comment'>/* Ap[K2] &lt;- Ap[0] + Ap[K2] * 2^((j + K2) * omega)</span></td></tr>
<tr class="codeline" data-linenumber="577"><td class="num" id="LN577">577</td><td class="line">	     <span class='comment'>Ap[0]  &lt;- Ap[0] + Ap[K2] * 2^(j * omega) */</span></td></tr>
<tr class="codeline" data-linenumber="578"><td class="num" id="LN578">578</td><td class="line">	  mpn_fft_mul_2exp_modF (tp, Ap[K2], j * omega, n);</td></tr>
<tr class="codeline" data-linenumber="579"><td class="num" id="LN579">579</td><td class="line">	  mpn_fft_sub_modF (Ap[K2], Ap[0], tp, n);</td></tr>
<tr class="codeline" data-linenumber="580"><td class="num" id="LN580">580</td><td class="line">	  mpn_fft_add_modF (Ap[0],  Ap[0], tp, n);</td></tr>
<tr class="codeline" data-linenumber="581"><td class="num" id="LN581">581</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="582"><td class="num" id="LN582">582</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="583"><td class="num" id="LN583">583</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="584"><td class="num" id="LN584">584</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="585"><td class="num" id="LN585">585</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="586"><td class="num" id="LN586">586</td><td class="line"><span class='comment'>/* R &lt;- A/2^k mod 2^(n*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="587"><td class="num" id="LN587">587</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="588"><td class="num" id="LN588">588</td><td class="line">mpn_fft_div_2exp_modF (mp_ptr r, mp_srcptr a, mp_bitcnt_t k, mp_size_t n)</td></tr>
<tr class="codeline" data-linenumber="589"><td class="num" id="LN589">589</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="590"><td class="num" id="LN590">590</td><td class="line">  mp_bitcnt_t i;</td></tr>
<tr class="codeline" data-linenumber="591"><td class="num" id="LN591">591</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="592"><td class="num" id="LN592">592</td><td class="line">  <span class='macro'>ASSERT (r != a)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="593"><td class="num" id="LN593">593</td><td class="line">  i = (mp_bitcnt_t) 2 * n * <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span> - k;</td></tr>
<tr class="codeline" data-linenumber="594"><td class="num" id="LN594">594</td><td class="line">  mpn_fft_mul_2exp_modF (r, a, i, n);</td></tr>
<tr class="codeline" data-linenumber="595"><td class="num" id="LN595">595</td><td class="line">  <span class='comment'>/* 1/2^k = 2^(2nL-k) mod 2^(n*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="596"><td class="num" id="LN596">596</td><td class="line">  <span class='comment'>/* normalize so that R &lt; 2^(n*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="597"><td class="num" id="LN597">597</td><td class="line">  mpn_fft_normalize (r, n);</td></tr>
<tr class="codeline" data-linenumber="598"><td class="num" id="LN598">598</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="599"><td class="num" id="LN599">599</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="600"><td class="num" id="LN600">600</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="601"><td class="num" id="LN601">601</td><td class="line"><span class='comment'>/* {rp,n} &lt;- {ap,an} mod 2^(n*GMP_NUMB_BITS)+1, n &lt;= an &lt;= 3*n.</span></td></tr>
<tr class="codeline" data-linenumber="602"><td class="num" id="LN602">602</td><td class="line">   <span class='comment'>Returns carry out, i.e. 1 iff {ap,an} = -1 mod 2^(n*GMP_NUMB_BITS)+1,</span></td></tr>
<tr class="codeline" data-linenumber="603"><td class="num" id="LN603">603</td><td class="line">   <span class='comment'>then {rp,n}=0.</span></td></tr>
<tr class="codeline" data-linenumber="604"><td class="num" id="LN604">604</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="605"><td class="num" id="LN605">605</td><td class="line"><span class='keyword'>static</span> mp_size_t</td></tr>
<tr class="codeline" data-linenumber="606"><td class="num" id="LN606">606</td><td class="line">mpn_fft_norm_modF (mp_ptr rp, mp_size_t n, mp_ptr ap, mp_size_t an)</td></tr>
<tr class="codeline" data-linenumber="607"><td class="num" id="LN607">607</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="608"><td class="num" id="LN608">608</td><td class="line">  mp_size_t l, m, rpn;</td></tr>
<tr class="codeline" data-linenumber="609"><td class="num" id="LN609">609</td><td class="line">  mp_limb_t cc;</td></tr>
<tr class="codeline" data-linenumber="610"><td class="num" id="LN610">610</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="611"><td class="num" id="LN611">611</td><td class="line">  <span class='macro'>ASSERT ((n &lt;= an) &amp;&amp; (an &lt;= 3 * n))<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="612"><td class="num" id="LN612">612</td><td class="line">  m = an - 2 * n;</td></tr>
<tr class="codeline" data-linenumber="613"><td class="num" id="LN613">613</td><td class="line">  <span class='keyword'>if</span> (m &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="614"><td class="num" id="LN614">614</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="615"><td class="num" id="LN615">615</td><td class="line">      l = n;</td></tr>
<tr class="codeline" data-linenumber="616"><td class="num" id="LN616">616</td><td class="line">      <span class='comment'>/* add {ap, m} and {ap+2n, m} in {rp, m} */</span></td></tr>
<tr class="codeline" data-linenumber="617"><td class="num" id="LN617">617</td><td class="line">      cc = <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (rp, ap, ap + 2 * n, m);</td></tr>
<tr class="codeline" data-linenumber="618"><td class="num" id="LN618">618</td><td class="line">      <span class='comment'>/* copy {ap+m, n-m} to {rp+m, n-m} */</span></td></tr>
<tr class="codeline" data-linenumber="619"><td class="num" id="LN619">619</td><td class="line">      rpn = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (rp + m, ap + m, n - m, cc);</td></tr>
<tr class="codeline" data-linenumber="620"><td class="num" id="LN620">620</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="621"><td class="num" id="LN621">621</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="622"><td class="num" id="LN622">622</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="623"><td class="num" id="LN623">623</td><td class="line">      l = an - n; <span class='comment'>/* l &lt;= n */</span></td></tr>
<tr class="codeline" data-linenumber="624"><td class="num" id="LN624">624</td><td class="line">      <span class='macro'>MPN_COPY (rp, ap, n)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (rp, ap, n); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="625"><td class="num" id="LN625">625</td><td class="line">      rpn = 0;</td></tr>
<tr class="codeline" data-linenumber="626"><td class="num" id="LN626">626</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="627"><td class="num" id="LN627">627</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="628"><td class="num" id="LN628">628</td><td class="line">  <span class='comment'>/* remains to subtract {ap+n, l} from {rp, n+1} */</span></td></tr>
<tr class="codeline" data-linenumber="629"><td class="num" id="LN629">629</td><td class="line">  cc = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (rp, rp, ap + n, l);</td></tr>
<tr class="codeline" data-linenumber="630"><td class="num" id="LN630">630</td><td class="line">  rpn -= <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (rp + l, rp + l, n - l, cc);</td></tr>
<tr class="codeline" data-linenumber="631"><td class="num" id="LN631">631</td><td class="line">  <span class='keyword'>if</span> (rpn &lt; 0) <span class='comment'>/* necessarily rpn = -1 */</span></td></tr>
<tr class="codeline" data-linenumber="632"><td class="num" id="LN632">632</td><td class="line">    rpn = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (rp, rp, n, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="633"><td class="num" id="LN633">633</td><td class="line">  <span class='keyword'>return</span> rpn;</td></tr>
<tr class="codeline" data-linenumber="634"><td class="num" id="LN634">634</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="635"><td class="num" id="LN635">635</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="636"><td class="num" id="LN636">636</td><td class="line"><span class='comment'>/* store in A[0..nprime] the first M bits from {n, nl},</span></td></tr>
<tr class="codeline" data-linenumber="637"><td class="num" id="LN637">637</td><td class="line">   <span class='comment'>in A[nprime+1..] the following M bits, ...</span></td></tr>
<tr class="codeline" data-linenumber="638"><td class="num" id="LN638">638</td><td class="line">   <span class='comment'>Assumes M is a multiple of GMP_NUMB_BITS (M = l * GMP_NUMB_BITS).</span></td></tr>
<tr class="codeline" data-linenumber="639"><td class="num" id="LN639">639</td><td class="line">   <span class='comment'>T must have space for at least (nprime + 1) limbs.</span></td></tr>
<tr class="codeline" data-linenumber="640"><td class="num" id="LN640">640</td><td class="line">   <span class='comment'>We must have nl &lt;= 2*K*l.</span></td></tr>
<tr class="codeline" data-linenumber="641"><td class="num" id="LN641">641</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="642"><td class="num" id="LN642">642</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="643"><td class="num" id="LN643">643</td><td class="line">mpn_mul_fft_decompose (mp_ptr A, mp_ptr *Ap, mp_size_t K, mp_size_t nprime,</td></tr>
<tr class="codeline" data-linenumber="644"><td class="num" id="LN644">644</td><td class="line">		       mp_srcptr n, mp_size_t nl, mp_size_t l, mp_size_t Mp,</td></tr>
<tr class="codeline" data-linenumber="645"><td class="num" id="LN645">645</td><td class="line">		       mp_ptr T)</td></tr>
<tr class="codeline" data-linenumber="646"><td class="num" id="LN646">646</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="647"><td class="num" id="LN647">647</td><td class="line">  mp_size_t i, j;</td></tr>
<tr class="codeline" data-linenumber="648"><td class="num" id="LN648">648</td><td class="line">  mp_ptr tmp;</td></tr>
<tr class="codeline" data-linenumber="649"><td class="num" id="LN649">649</td><td class="line">  mp_size_t Kl = K * l;</td></tr>
<tr class="codeline" data-linenumber="650"><td class="num" id="LN650">650</td><td class="line">  <span class='macro'>TMP_DECL<span class='macro_popup'>struct tmp_reentrant_t *__tmp_marker</span></span>;</td></tr>
<tr class="codeline" data-linenumber="651"><td class="num" id="LN651">651</td><td class="line">  <span class='macro'>TMP_MARK<span class='macro_popup'>__tmp_marker = 0</span></span>;</td></tr>
<tr class="codeline" data-linenumber="652"><td class="num" id="LN652">652</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="653"><td class="num" id="LN653">653</td><td class="line">  <span class='keyword'>if</span> (nl &gt; Kl) <span class='comment'>/* normalize {n, nl} mod 2^(Kl*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="654"><td class="num" id="LN654">654</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="655"><td class="num" id="LN655">655</td><td class="line">      mp_size_t dif = nl - Kl;</td></tr>
<tr class="codeline" data-linenumber="656"><td class="num" id="LN656">656</td><td class="line">      mp_limb_signed_t cy;</td></tr>
<tr class="codeline" data-linenumber="657"><td class="num" id="LN657">657</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="658"><td class="num" id="LN658">658</td><td class="line">      tmp = <span class='macro'>TMP_BALLOC_LIMBS(Kl + 1)<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>Kl + 1) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="659"><td class="num" id="LN659">659</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="660"><td class="num" id="LN660">660</td><td class="line">      <span class='keyword'>if</span> (dif &gt; Kl)</td></tr>
<tr class="codeline" data-linenumber="661"><td class="num" id="LN661">661</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="662"><td class="num" id="LN662">662</td><td class="line">	  <span class='keyword'>int</span> subp = 0;</td></tr>
<tr class="codeline" data-linenumber="663"><td class="num" id="LN663">663</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="664"><td class="num" id="LN664">664</td><td class="line">	  cy = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (tmp, n, n + Kl, Kl);</td></tr>
<tr class="codeline" data-linenumber="665"><td class="num" id="LN665">665</td><td class="line">	  n += 2 * Kl;</td></tr>
<tr class="codeline" data-linenumber="666"><td class="num" id="LN666">666</td><td class="line">	  dif -= Kl;</td></tr>
<tr class="codeline" data-linenumber="667"><td class="num" id="LN667">667</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="668"><td class="num" id="LN668">668</td><td class="line">	  <span class='comment'>/* now dif &gt; 0 */</span></td></tr>
<tr class="codeline" data-linenumber="669"><td class="num" id="LN669">669</td><td class="line">	  <span class='keyword'>while</span> (dif &gt; Kl)</td></tr>
<tr class="codeline" data-linenumber="670"><td class="num" id="LN670">670</td><td class="line">	    {</td></tr>
<tr class="codeline" data-linenumber="671"><td class="num" id="LN671">671</td><td class="line">	      <span class='keyword'>if</span> (subp)</td></tr>
<tr class="codeline" data-linenumber="672"><td class="num" id="LN672">672</td><td class="line">		cy += <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (tmp, tmp, n, Kl);</td></tr>
<tr class="codeline" data-linenumber="673"><td class="num" id="LN673">673</td><td class="line">	      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="674"><td class="num" id="LN674">674</td><td class="line">		cy -= <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (tmp, tmp, n, Kl);</td></tr>
<tr class="codeline" data-linenumber="675"><td class="num" id="LN675">675</td><td class="line">	      subp ^= 1;</td></tr>
<tr class="codeline" data-linenumber="676"><td class="num" id="LN676">676</td><td class="line">	      n += Kl;</td></tr>
<tr class="codeline" data-linenumber="677"><td class="num" id="LN677">677</td><td class="line">	      dif -= Kl;</td></tr>
<tr class="codeline" data-linenumber="678"><td class="num" id="LN678">678</td><td class="line">	    }</td></tr>
<tr class="codeline" data-linenumber="679"><td class="num" id="LN679">679</td><td class="line">	  <span class='comment'>/* now dif &lt;= Kl */</span></td></tr>
<tr class="codeline" data-linenumber="680"><td class="num" id="LN680">680</td><td class="line">	  <span class='keyword'>if</span> (subp)</td></tr>
<tr class="codeline" data-linenumber="681"><td class="num" id="LN681">681</td><td class="line">	    cy += <span class='macro'>mpn_sub<span class='macro_popup'>__gmpn_sub</span></span> (tmp, tmp, Kl, n, dif);</td></tr>
<tr class="codeline" data-linenumber="682"><td class="num" id="LN682">682</td><td class="line">	  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="683"><td class="num" id="LN683">683</td><td class="line">	    cy -= <span class='macro'>mpn_add<span class='macro_popup'>__gmpn_add</span></span> (tmp, tmp, Kl, n, dif);</td></tr>
<tr class="codeline" data-linenumber="684"><td class="num" id="LN684">684</td><td class="line">	  <span class='keyword'>if</span> (cy &gt;= 0)</td></tr>
<tr class="codeline" data-linenumber="685"><td class="num" id="LN685">685</td><td class="line">	    cy = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (tmp, tmp, Kl, cy);</td></tr>
<tr class="codeline" data-linenumber="686"><td class="num" id="LN686">686</td><td class="line">	  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="687"><td class="num" id="LN687">687</td><td class="line">	    cy = <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (tmp, tmp, Kl, -cy);</td></tr>
<tr class="codeline" data-linenumber="688"><td class="num" id="LN688">688</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="689"><td class="num" id="LN689">689</td><td class="line">      <span class='keyword'>else</span> <span class='comment'>/* dif &lt;= Kl, i.e. nl &lt;= 2 * Kl */</span></td></tr>
<tr class="codeline" data-linenumber="690"><td class="num" id="LN690">690</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="691"><td class="num" id="LN691">691</td><td class="line">	  cy = <span class='macro'>mpn_sub<span class='macro_popup'>__gmpn_sub</span></span> (tmp, n, Kl, n + Kl, dif);</td></tr>
<tr class="codeline" data-linenumber="692"><td class="num" id="LN692">692</td><td class="line">	  cy = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (tmp, tmp, Kl, cy);</td></tr>
<tr class="codeline" data-linenumber="693"><td class="num" id="LN693">693</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="694"><td class="num" id="LN694">694</td><td class="line">      tmp[Kl] = cy;</td></tr>
<tr class="codeline" data-linenumber="695"><td class="num" id="LN695">695</td><td class="line">      nl = Kl + 1;</td></tr>
<tr class="codeline" data-linenumber="696"><td class="num" id="LN696">696</td><td class="line">      n = tmp;</td></tr>
<tr class="codeline" data-linenumber="697"><td class="num" id="LN697">697</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="698"><td class="num" id="LN698">698</td><td class="line">  <span class='keyword'>for</span> (i = 0; i &lt; K; i++)</td></tr>
<tr class="codeline" data-linenumber="699"><td class="num" id="LN699">699</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="700"><td class="num" id="LN700">700</td><td class="line">      Ap[i] = A;</td></tr>
<tr class="codeline" data-linenumber="701"><td class="num" id="LN701">701</td><td class="line">      <span class='comment'>/* store the next M bits of n into A[0..nprime] */</span></td></tr>
<tr class="codeline" data-linenumber="702"><td class="num" id="LN702">702</td><td class="line">      <span class='keyword'>if</span> (nl &gt; 0) <span class='comment'>/* nl is the number of remaining limbs */</span></td></tr>
<tr class="codeline" data-linenumber="703"><td class="num" id="LN703">703</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="704"><td class="num" id="LN704">704</td><td class="line">	  j = (l &lt;= nl &amp;&amp; i &lt; K - 1) ? l : nl; <span class='comment'>/* store j next limbs */</span></td></tr>
<tr class="codeline" data-linenumber="705"><td class="num" id="LN705">705</td><td class="line">	  nl -= j;</td></tr>
<tr class="codeline" data-linenumber="706"><td class="num" id="LN706">706</td><td class="line">	  <span class='macro'>MPN_COPY (T, n, j)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (T, n, j); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="707"><td class="num" id="LN707">707</td><td class="line">	  <span class='macro'>MPN_ZERO (T + j, nprime + 1 - j)<span class='macro_popup'>do { do {} while (0); if ((nprime + 1 - j) != 0) do { mp_ptr __dst<br> = (T + j); mp_size_t __n = (nprime + 1 - j); do {} while (0)<br>; do *__dst++ = (((mp_limb_t) 0L)); while (--__n); } while (0<br>); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="708"><td class="num" id="LN708">708</td><td class="line">	  n += l;</td></tr>
<tr class="codeline" data-linenumber="709"><td class="num" id="LN709">709</td><td class="line">	  mpn_fft_mul_2exp_modF (A, T, i * Mp, nprime);</td></tr>
<tr class="codeline" data-linenumber="710"><td class="num" id="LN710">710</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="711"><td class="num" id="LN711">711</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="712"><td class="num" id="LN712">712</td><td class="line">	<span class='macro'>MPN_ZERO (A, nprime + 1)<span class='macro_popup'>do { do {} while (0); if ((nprime + 1) != 0) do { mp_ptr __dst<br> = (A); mp_size_t __n = (nprime + 1); do {} while (0); do *__dst<br>++ = (((mp_limb_t) 0L)); while (--__n); } while (0); } while (<br>0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="713"><td class="num" id="LN713">713</td><td class="line">      A += nprime + 1;</td></tr>
<tr class="codeline" data-linenumber="714"><td class="num" id="LN714">714</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="715"><td class="num" id="LN715">715</td><td class="line">  <span class='macro'>ASSERT_ALWAYS (nl == 0)<span class='macro_popup'>do { if (__builtin_expect ((!(nl == 0)) != 0, 0)) __gmp_assert_fail<br> ("mul_fft.c", 715, "nl == 0"); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="716"><td class="num" id="LN716">716</td><td class="line">  <span class='macro'>TMP_FREE<span class='macro_popup'>do { if (__builtin_expect ((__tmp_marker != 0) != 0, 0)) __gmp_tmp_reentrant_free<br> (__tmp_marker); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="717"><td class="num" id="LN717">717</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="718"><td class="num" id="LN718">718</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="719"><td class="num" id="LN719">719</td><td class="line"><span class='comment'>/* op &lt;- n*m mod 2^N+1 with fft of size 2^k where N=pl*GMP_NUMB_BITS</span></td></tr>
<tr class="codeline" data-linenumber="720"><td class="num" id="LN720">720</td><td class="line">   <span class='comment'>op is pl limbs, its high bit is returned.</span></td></tr>
<tr class="codeline" data-linenumber="721"><td class="num" id="LN721">721</td><td class="line">   <span class='comment'>One must have pl = mpn_fft_next_size (pl, k).</span></td></tr>
<tr class="codeline" data-linenumber="722"><td class="num" id="LN722">722</td><td class="line">   <span class='comment'>T must have space for 2 * (nprime + 1) limbs.</span></td></tr>
<tr class="codeline" data-linenumber="723"><td class="num" id="LN723">723</td><td class="line"><span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="724"><td class="num" id="LN724">724</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="725"><td class="num" id="LN725">725</td><td class="line"><span class='keyword'>static</span> mp_limb_t</td></tr>
<tr class="codeline" data-linenumber="726"><td class="num" id="LN726">726</td><td class="line">mpn_mul_fft_internal (mp_ptr op, mp_size_t pl, <span class='keyword'>int</span> k,</td></tr>
<tr class="codeline" data-linenumber="727"><td class="num" id="LN727">727</td><td class="line">		      mp_ptr *Ap, mp_ptr *Bp, mp_ptr A, mp_ptr B,</td></tr>
<tr class="codeline" data-linenumber="728"><td class="num" id="LN728">728</td><td class="line">		      mp_size_t nprime, mp_size_t l, mp_size_t Mp,</td></tr>
<tr class="codeline" data-linenumber="729"><td class="num" id="LN729">729</td><td class="line">		      <span class='keyword'>int</span> **fft_l, mp_ptr T, <span class='keyword'>int</span> sqr)</td></tr>
<tr class="codeline" data-linenumber="730"><td class="num" id="LN730">730</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="731"><td class="num" id="LN731">731</td><td class="line">  mp_size_t K, i, pla, lo, sh, j;</td></tr>
<tr class="codeline" data-linenumber="732"><td class="num" id="LN732">732</td><td class="line">  mp_ptr p;</td></tr>
<tr class="codeline" data-linenumber="733"><td class="num" id="LN733">733</td><td class="line">  mp_limb_t cc;</td></tr>
<tr class="codeline" data-linenumber="734"><td class="num" id="LN734">734</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="735"><td class="num" id="LN735">735</td><td class="line">  K = (mp_size_t) 1 &lt;&lt; k;</td></tr>
<tr class="codeline" data-linenumber="736"><td class="num" id="LN736">736</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="737"><td class="num" id="LN737">737</td><td class="line">  <span class='comment'>/* direct fft's */</span></td></tr>
<tr class="codeline" data-linenumber="738"><td class="num" id="LN738">738</td><td class="line">  mpn_fft_fft (Ap, K, fft_l + k, 2 * Mp, nprime, 1, T);</td></tr>
<tr class="codeline" data-linenumber="739"><td class="num" id="LN739">739</td><td class="line">  <span class='keyword'>if</span> (!sqr)</td></tr>
<tr class="codeline" data-linenumber="740"><td class="num" id="LN740">740</td><td class="line">    mpn_fft_fft (Bp, K, fft_l + k, 2 * Mp, nprime, 1, T);</td></tr>
<tr class="codeline" data-linenumber="741"><td class="num" id="LN741">741</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="742"><td class="num" id="LN742">742</td><td class="line">  <span class='comment'>/* term to term multiplications */</span></td></tr>
<tr class="codeline" data-linenumber="743"><td class="num" id="LN743">743</td><td class="line">  mpn_fft_mul_modF_K (Ap, sqr ? Ap : Bp, nprime, K);</td></tr>
<tr class="codeline" data-linenumber="744"><td class="num" id="LN744">744</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="745"><td class="num" id="LN745">745</td><td class="line">  <span class='comment'>/* inverse fft's */</span></td></tr>
<tr class="codeline" data-linenumber="746"><td class="num" id="LN746">746</td><td class="line">  mpn_fft_fftinv (Ap, K, 2 * Mp, nprime, T);</td></tr>
<tr class="codeline" data-linenumber="747"><td class="num" id="LN747">747</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="748"><td class="num" id="LN748">748</td><td class="line">  <span class='comment'>/* division of terms after inverse fft */</span></td></tr>
<tr class="codeline" data-linenumber="749"><td class="num" id="LN749">749</td><td class="line">  Bp[0] = T + nprime + 1;</td></tr>
<tr class="codeline" data-linenumber="750"><td class="num" id="LN750">750</td><td class="line">  mpn_fft_div_2exp_modF (Bp[0], Ap[0], k, nprime);</td></tr>
<tr class="codeline" data-linenumber="751"><td class="num" id="LN751">751</td><td class="line">  <span class='keyword'>for</span> (i = 1; i &lt; K; i++)</td></tr>
<tr class="codeline" data-linenumber="752"><td class="num" id="LN752">752</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="753"><td class="num" id="LN753">753</td><td class="line">      Bp[i] = Ap[i - 1];</td></tr>
<tr class="codeline" data-linenumber="754"><td class="num" id="LN754">754</td><td class="line">      mpn_fft_div_2exp_modF (Bp[i], Ap[i], k + (K - i) * Mp, nprime);</td></tr>
<tr class="codeline" data-linenumber="755"><td class="num" id="LN755">755</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="756"><td class="num" id="LN756">756</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="757"><td class="num" id="LN757">757</td><td class="line">  <span class='comment'>/* addition of terms in result p */</span></td></tr>
<tr class="codeline" data-linenumber="758"><td class="num" id="LN758">758</td><td class="line">  <span class='macro'>MPN_ZERO (T, nprime + 1)<span class='macro_popup'>do { do {} while (0); if ((nprime + 1) != 0) do { mp_ptr __dst<br> = (T); mp_size_t __n = (nprime + 1); do {} while (0); do *__dst<br>++ = (((mp_limb_t) 0L)); while (--__n); } while (0); } while (<br>0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="759"><td class="num" id="LN759">759</td><td class="line">  pla = l * (K - 1) + nprime + 1; <span class='comment'>/* number of required limbs for p */</span></td></tr>
<tr class="codeline" data-linenumber="760"><td class="num" id="LN760">760</td><td class="line">  p = B; <span class='comment'>/* B has K*(n' + 1) limbs, which is &gt;= pla, i.e. enough */</span></td></tr>
<tr class="codeline" data-linenumber="761"><td class="num" id="LN761">761</td><td class="line">  <span class='macro'>MPN_ZERO (p, pla)<span class='macro_popup'>do { do {} while (0); if ((pla) != 0) do { mp_ptr __dst = (p)<br>; mp_size_t __n = (pla); do {} while (0); do *__dst++ = (((mp_limb_t<br>) 0L)); while (--__n); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="762"><td class="num" id="LN762">762</td><td class="line">  cc = 0; <span class='comment'>/* will accumulate the (signed) carry at p[pla] */</span></td></tr>
<tr class="codeline" data-linenumber="763"><td class="num" id="LN763">763</td><td class="line">  <span class='keyword'>for</span> (i = K - 1, lo = l * i + nprime,sh = l * i; i &gt;= 0; i--,lo -= l,sh -= l)</td></tr>
<tr class="codeline" data-linenumber="764"><td class="num" id="LN764">764</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="765"><td class="num" id="LN765">765</td><td class="line">      mp_ptr n = p + sh;</td></tr>
<tr class="codeline" data-linenumber="766"><td class="num" id="LN766">766</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="767"><td class="num" id="LN767">767</td><td class="line">      j = (K - i) &amp; (K - 1);</td></tr>
<tr class="codeline" data-linenumber="768"><td class="num" id="LN768">768</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="769"><td class="num" id="LN769">769</td><td class="line">      <span class='keyword'>if</span> (<span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (n, n, Bp[j], nprime + 1))</td></tr>
<tr class="codeline" data-linenumber="770"><td class="num" id="LN770">770</td><td class="line">	cc += <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (n + nprime + 1, n + nprime + 1,</td></tr>
<tr class="codeline" data-linenumber="771"><td class="num" id="LN771">771</td><td class="line">			  pla - sh - nprime - 1, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="772"><td class="num" id="LN772">772</td><td class="line">      T[2 * l] = i + 1; <span class='comment'>/* T = (i + 1)*2^(2*M) */</span></td></tr>
<tr class="codeline" data-linenumber="773"><td class="num" id="LN773">773</td><td class="line">      <span class='keyword'>if</span> (<span class='macro'>mpn_cmp<span class='macro_popup'>__gmpn_cmp</span></span> (Bp[j], T, nprime + 1) &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="774"><td class="num" id="LN774">774</td><td class="line">	{ <span class='comment'>/* subtract 2^N'+1 */</span></td></tr>
<tr class="codeline" data-linenumber="775"><td class="num" id="LN775">775</td><td class="line">	  cc -= <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (n, n, pla - sh, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="776"><td class="num" id="LN776">776</td><td class="line">	  cc -= <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (p + lo, p + lo, pla - lo, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="777"><td class="num" id="LN777">777</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="778"><td class="num" id="LN778">778</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="779"><td class="num" id="LN779">779</td><td class="line">  <span class='keyword'>if</span> (cc == -<span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>)</td></tr>
<tr class="codeline" data-linenumber="780"><td class="num" id="LN780">780</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="781"><td class="num" id="LN781">781</td><td class="line">      <span class='keyword'>if</span> ((cc = <span class="mrange"><span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (p + pla - pl, p + pla - pl, pl, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>)</span>))</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgEvent" style="margin-left:12ex">Although the value stored to 'cc' is used in the enclosing expression, the value is never actually read from 'cc'</div></td></tr>
<tr class="codeline" data-linenumber="782"><td class="num" id="LN782">782</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="783"><td class="num" id="LN783">783</td><td class="line">	  <span class='comment'>/* p[pla-pl]...p[pla-1] are all zero */</span></td></tr>
<tr class="codeline" data-linenumber="784"><td class="num" id="LN784">784</td><td class="line">	  <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (p + pla - pl - 1, p + pla - pl - 1, pl + 1, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="785"><td class="num" id="LN785">785</td><td class="line">	  <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (p + pla - 1, p + pla - 1, 1, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="786"><td class="num" id="LN786">786</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="787"><td class="num" id="LN787">787</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="788"><td class="num" id="LN788">788</td><td class="line">  <span class='keyword'>else</span> <span class='keyword'>if</span> (cc == 1)</td></tr>
<tr class="codeline" data-linenumber="789"><td class="num" id="LN789">789</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="790"><td class="num" id="LN790">790</td><td class="line">      <span class='keyword'>if</span> (pla &gt;= 2 * pl)</td></tr>
<tr class="codeline" data-linenumber="791"><td class="num" id="LN791">791</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="792"><td class="num" id="LN792">792</td><td class="line">	  <span class='keyword'>while</span> ((cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (p + pla - 2 * pl, p + pla - 2 * pl, 2 * pl, cc)))</td></tr>
<tr class="codeline" data-linenumber="793"><td class="num" id="LN793">793</td><td class="line">	    ;</td></tr>
<tr class="codeline" data-linenumber="794"><td class="num" id="LN794">794</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="795"><td class="num" id="LN795">795</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="796"><td class="num" id="LN796">796</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="797"><td class="num" id="LN797">797</td><td class="line">	  cc = <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (p + pla - pl, p + pla - pl, pl, cc);</td></tr>
<tr class="codeline" data-linenumber="798"><td class="num" id="LN798">798</td><td class="line">	  <span class='macro'>ASSERT (cc == 0)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="799"><td class="num" id="LN799">799</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="800"><td class="num" id="LN800">800</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="801"><td class="num" id="LN801">801</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="802"><td class="num" id="LN802">802</td><td class="line">    <span class='macro'>ASSERT (cc == 0)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="803"><td class="num" id="LN803">803</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="804"><td class="num" id="LN804">804</td><td class="line">  <span class='comment'>/* here p &lt; 2^(2M) [K 2^(M(K-1)) + (K-1) 2^(M(K-2)) + ... ]</span></td></tr>
<tr class="codeline" data-linenumber="805"><td class="num" id="LN805">805</td><td class="line">     <span class='comment'>&lt; K 2^(2M) [2^(M(K-1)) + 2^(M(K-2)) + ... ]</span></td></tr>
<tr class="codeline" data-linenumber="806"><td class="num" id="LN806">806</td><td class="line">     <span class='comment'>&lt; K 2^(2M) 2^(M(K-1))*2 = 2^(M*K+M+k+1) */</span></td></tr>
<tr class="codeline" data-linenumber="807"><td class="num" id="LN807">807</td><td class="line">  <span class='keyword'>return</span> mpn_fft_norm_modF (op, pl, p, pla);</td></tr>
<tr class="codeline" data-linenumber="808"><td class="num" id="LN808">808</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="809"><td class="num" id="LN809">809</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="810"><td class="num" id="LN810">810</td><td class="line"><span class='comment'>/* return the lcm of a and 2^k */</span></td></tr>
<tr class="codeline" data-linenumber="811"><td class="num" id="LN811">811</td><td class="line"><span class='keyword'>static</span> mp_bitcnt_t</td></tr>
<tr class="codeline" data-linenumber="812"><td class="num" id="LN812">812</td><td class="line">mpn_mul_fft_lcm (mp_bitcnt_t a, <span class='keyword'>int</span> k)</td></tr>
<tr class="codeline" data-linenumber="813"><td class="num" id="LN813">813</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="814"><td class="num" id="LN814">814</td><td class="line">  mp_bitcnt_t l = k;</td></tr>
<tr class="codeline" data-linenumber="815"><td class="num" id="LN815">815</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="816"><td class="num" id="LN816">816</td><td class="line">  <span class='keyword'>while</span> (a % 2 == 0 &amp;&amp; k &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="817"><td class="num" id="LN817">817</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="818"><td class="num" id="LN818">818</td><td class="line">      a &gt;&gt;= 1;</td></tr>
<tr class="codeline" data-linenumber="819"><td class="num" id="LN819">819</td><td class="line">      k --;</td></tr>
<tr class="codeline" data-linenumber="820"><td class="num" id="LN820">820</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="821"><td class="num" id="LN821">821</td><td class="line">  <span class='keyword'>return</span> a &lt;&lt; l;</td></tr>
<tr class="codeline" data-linenumber="822"><td class="num" id="LN822">822</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="823"><td class="num" id="LN823">823</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="824"><td class="num" id="LN824">824</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="825"><td class="num" id="LN825">825</td><td class="line">mp_limb_t</td></tr>
<tr class="codeline" data-linenumber="826"><td class="num" id="LN826">826</td><td class="line"><span class='macro'>mpn_mul_fft<span class='macro_popup'>__gmpn_mul_fft</span></span> (mp_ptr op, mp_size_t pl,</td></tr>
<tr class="codeline" data-linenumber="827"><td class="num" id="LN827">827</td><td class="line">	     mp_srcptr n, mp_size_t nl,</td></tr>
<tr class="codeline" data-linenumber="828"><td class="num" id="LN828">828</td><td class="line">	     mp_srcptr m, mp_size_t ml,</td></tr>
<tr class="codeline" data-linenumber="829"><td class="num" id="LN829">829</td><td class="line">	     <span class='keyword'>int</span> k)</td></tr>
<tr class="codeline" data-linenumber="830"><td class="num" id="LN830">830</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="831"><td class="num" id="LN831">831</td><td class="line">  <span class='keyword'>int</span> i;</td></tr>
<tr class="codeline" data-linenumber="832"><td class="num" id="LN832">832</td><td class="line">  mp_size_t K, maxLK;</td></tr>
<tr class="codeline" data-linenumber="833"><td class="num" id="LN833">833</td><td class="line">  mp_size_t N, Nprime, nprime, M, Mp, l;</td></tr>
<tr class="codeline" data-linenumber="834"><td class="num" id="LN834">834</td><td class="line">  mp_ptr *Ap, *Bp, A, T, B;</td></tr>
<tr class="codeline" data-linenumber="835"><td class="num" id="LN835">835</td><td class="line">  <span class='keyword'>int</span> **fft_l, *tmp;</td></tr>
<tr class="codeline" data-linenumber="836"><td class="num" id="LN836">836</td><td class="line">  <span class='keyword'>int</span> sqr = (n == m &amp;&amp; nl == ml);</td></tr>
<tr class="codeline" data-linenumber="837"><td class="num" id="LN837">837</td><td class="line">  mp_limb_t h;</td></tr>
<tr class="codeline" data-linenumber="838"><td class="num" id="LN838">838</td><td class="line">  <span class='macro'>TMP_DECL<span class='macro_popup'>struct tmp_reentrant_t *__tmp_marker</span></span>;</td></tr>
<tr class="codeline" data-linenumber="839"><td class="num" id="LN839">839</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="840"><td class="num" id="LN840">840</td><td class="line">  TRACE (printf (<span class='string_literal'>"\nmpn_mul_fft pl=%ld nl=%ld ml=%ld k=%d\n"</span>, pl, nl, ml, k));</td></tr>
<tr class="codeline" data-linenumber="841"><td class="num" id="LN841">841</td><td class="line">  <span class='macro'>ASSERT_ALWAYS (mpn_fft_next_size (pl, k) == pl)<span class='macro_popup'>do { if (__builtin_expect ((!(__gmpn_fft_next_size (pl, k) ==<br> pl)) != 0, 0)) __gmp_assert_fail ("mul_fft.c", 841, "__gmpn_fft_next_size (pl, k) == pl"<br>); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="842"><td class="num" id="LN842">842</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="843"><td class="num" id="LN843">843</td><td class="line">  <span class='macro'>TMP_MARK<span class='macro_popup'>__tmp_marker = 0</span></span>;</td></tr>
<tr class="codeline" data-linenumber="844"><td class="num" id="LN844">844</td><td class="line">  N = pl * <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="845"><td class="num" id="LN845">845</td><td class="line">  fft_l = <span class='macro'>TMP_BALLOC_TYPE (k + 1, <span class='keyword'>int</span> *)<span class='macro_popup'>((int * *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (k +<br> 1) * sizeof (int *)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="846"><td class="num" id="LN846">846</td><td class="line">  tmp = <span class='macro'>TMP_BALLOC_TYPE ((size_t) 2 &lt;&lt; k, <span class='keyword'>int</span>)<span class='macro_popup'>((int *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, ((size_t<br>) 2 &lt;&lt; k) * sizeof (int)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="847"><td class="num" id="LN847">847</td><td class="line">  <span class='keyword'>for</span> (i = 0; i &lt;= k; i++)</td></tr>
<tr class="codeline" data-linenumber="848"><td class="num" id="LN848">848</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="849"><td class="num" id="LN849">849</td><td class="line">      fft_l[i] = tmp;</td></tr>
<tr class="codeline" data-linenumber="850"><td class="num" id="LN850">850</td><td class="line">      tmp += (mp_size_t) 1 &lt;&lt; i;</td></tr>
<tr class="codeline" data-linenumber="851"><td class="num" id="LN851">851</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="852"><td class="num" id="LN852">852</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="853"><td class="num" id="LN853">853</td><td class="line">  mpn_fft_initl (fft_l, k);</td></tr>
<tr class="codeline" data-linenumber="854"><td class="num" id="LN854">854</td><td class="line">  K = (mp_size_t) 1 &lt;&lt; k;</td></tr>
<tr class="codeline" data-linenumber="855"><td class="num" id="LN855">855</td><td class="line">  M = N &gt;&gt; k;	<span class='comment'>/* N = 2^k M */</span></td></tr>
<tr class="codeline" data-linenumber="856"><td class="num" id="LN856">856</td><td class="line">  l = 1 + (M - 1) / <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="857"><td class="num" id="LN857">857</td><td class="line">  maxLK = mpn_mul_fft_lcm (<span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>, k); <span class='comment'>/* lcm (GMP_NUMB_BITS, 2^k) */</span></td></tr>
<tr class="codeline" data-linenumber="858"><td class="num" id="LN858">858</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="859"><td class="num" id="LN859">859</td><td class="line">  Nprime = (1 + (2 * M + k + 2) / maxLK) * maxLK;</td></tr>
<tr class="codeline" data-linenumber="860"><td class="num" id="LN860">860</td><td class="line">  <span class='comment'>/* Nprime = ceil((2*M+k+3)/maxLK)*maxLK; */</span></td></tr>
<tr class="codeline" data-linenumber="861"><td class="num" id="LN861">861</td><td class="line">  nprime = Nprime / <span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="862"><td class="num" id="LN862">862</td><td class="line">  TRACE (printf (<span class='string_literal'>"N=%ld K=%ld, M=%ld, l=%ld, maxLK=%ld, Np=%ld, np=%ld\n"</span>,</td></tr>
<tr class="codeline" data-linenumber="863"><td class="num" id="LN863">863</td><td class="line">		 N, K, M, l, maxLK, Nprime, nprime));</td></tr>
<tr class="codeline" data-linenumber="864"><td class="num" id="LN864">864</td><td class="line">  <span class='comment'>/* we should ensure that recursively, nprime is a multiple of the next K */</span></td></tr>
<tr class="codeline" data-linenumber="865"><td class="num" id="LN865">865</td><td class="line">  <span class='keyword'>if</span> (nprime &gt;= (sqr ? <span class='macro'>SQR_FFT_MODF_THRESHOLD<span class='macro_popup'>570</span></span> : <span class='macro'>MUL_FFT_MODF_THRESHOLD<span class='macro_popup'>654</span></span>))</td></tr>
<tr class="codeline" data-linenumber="866"><td class="num" id="LN866">866</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="867"><td class="num" id="LN867">867</td><td class="line">      mp_size_t K2;</td></tr>
<tr class="codeline" data-linenumber="868"><td class="num" id="LN868">868</td><td class="line">      <span class='keyword'>for</span> (;;)</td></tr>
<tr class="codeline" data-linenumber="869"><td class="num" id="LN869">869</td><td class="line">	{</td></tr>
<tr class="codeline" data-linenumber="870"><td class="num" id="LN870">870</td><td class="line">	  K2 = (mp_size_t) 1 &lt;&lt; <span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (nprime, sqr);</td></tr>
<tr class="codeline" data-linenumber="871"><td class="num" id="LN871">871</td><td class="line">	  <span class='keyword'>if</span> ((nprime &amp; (K2 - 1)) == 0)</td></tr>
<tr class="codeline" data-linenumber="872"><td class="num" id="LN872">872</td><td class="line">	    <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="873"><td class="num" id="LN873">873</td><td class="line">	  nprime = (nprime + K2 - 1) &amp; -K2;</td></tr>
<tr class="codeline" data-linenumber="874"><td class="num" id="LN874">874</td><td class="line">	  Nprime = nprime * <span class='macro'>GMP_LIMB_BITS<span class='macro_popup'>64</span></span>;</td></tr>
<tr class="codeline" data-linenumber="875"><td class="num" id="LN875">875</td><td class="line">	  <span class='comment'>/* warning: since nprime changed, K2 may change too! */</span></td></tr>
<tr class="codeline" data-linenumber="876"><td class="num" id="LN876">876</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="877"><td class="num" id="LN877">877</td><td class="line">      TRACE (printf (<span class='string_literal'>"new maxLK=%ld, Np=%ld, np=%ld\n"</span>, maxLK, Nprime, nprime));</td></tr>
<tr class="codeline" data-linenumber="878"><td class="num" id="LN878">878</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="879"><td class="num" id="LN879">879</td><td class="line">  <span class='macro'>ASSERT_ALWAYS (nprime &lt; pl)<span class='macro_popup'>do { if (__builtin_expect ((!(nprime &lt; pl)) != 0, 0)) __gmp_assert_fail<br> ("mul_fft.c", 879, "nprime &lt; pl"); } while (0)</span></span>; <span class='comment'>/* otherwise we'll loop */</span></td></tr>
<tr class="codeline" data-linenumber="880"><td class="num" id="LN880">880</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="881"><td class="num" id="LN881">881</td><td class="line">  T = <span class='macro'>TMP_BALLOC_LIMBS (2 * (nprime + 1))<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>2 * (nprime + 1)) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="882"><td class="num" id="LN882">882</td><td class="line">  Mp = Nprime &gt;&gt; k;</td></tr>
<tr class="codeline" data-linenumber="883"><td class="num" id="LN883">883</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="884"><td class="num" id="LN884">884</td><td class="line">  TRACE (printf (<span class='string_literal'>"%ldx%ld limbs -&gt; %ld times %ldx%ld limbs (%1.2f)\n"</span>,</td></tr>
<tr class="codeline" data-linenumber="885"><td class="num" id="LN885">885</td><td class="line">		pl, pl, K, nprime, nprime, 2.0 * (<span class='keyword'>double</span>) N / Nprime / K);</td></tr>
<tr class="codeline" data-linenumber="886"><td class="num" id="LN886">886</td><td class="line">	 printf (<span class='string_literal'>"   temp space %ld\n"</span>, 2 * K * (nprime + 1)));</td></tr>
<tr class="codeline" data-linenumber="887"><td class="num" id="LN887">887</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="888"><td class="num" id="LN888">888</td><td class="line">  A = <span class='macro'>TMP_BALLOC_LIMBS (K * (nprime + 1))<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>K * (nprime + 1)) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="889"><td class="num" id="LN889">889</td><td class="line">  Ap = <span class='macro'>TMP_BALLOC_MP_PTRS (K)<span class='macro_popup'>((mp_ptr *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (K)<br> * sizeof (mp_ptr)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="890"><td class="num" id="LN890">890</td><td class="line">  mpn_mul_fft_decompose (A, Ap, K, nprime, n, nl, l, Mp, T);</td></tr>
<tr class="codeline" data-linenumber="891"><td class="num" id="LN891">891</td><td class="line">  <span class='keyword'>if</span> (sqr)</td></tr>
<tr class="codeline" data-linenumber="892"><td class="num" id="LN892">892</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="893"><td class="num" id="LN893">893</td><td class="line">      mp_size_t pla;</td></tr>
<tr class="codeline" data-linenumber="894"><td class="num" id="LN894">894</td><td class="line">      pla = l * (K - 1) + nprime + 1; <span class='comment'>/* number of required limbs for p */</span></td></tr>
<tr class="codeline" data-linenumber="895"><td class="num" id="LN895">895</td><td class="line">      B = <span class='macro'>TMP_BALLOC_LIMBS (pla)<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>pla) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="896"><td class="num" id="LN896">896</td><td class="line">      Bp = <span class='macro'>TMP_BALLOC_MP_PTRS (K)<span class='macro_popup'>((mp_ptr *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (K)<br> * sizeof (mp_ptr)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="897"><td class="num" id="LN897">897</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="898"><td class="num" id="LN898">898</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="899"><td class="num" id="LN899">899</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="900"><td class="num" id="LN900">900</td><td class="line">      B = <span class='macro'>TMP_BALLOC_LIMBS (K * (nprime + 1))<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>K * (nprime + 1)) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="901"><td class="num" id="LN901">901</td><td class="line">      Bp = <span class='macro'>TMP_BALLOC_MP_PTRS (K)<span class='macro_popup'>((mp_ptr *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (K)<br> * sizeof (mp_ptr)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="902"><td class="num" id="LN902">902</td><td class="line">      mpn_mul_fft_decompose (B, Bp, K, nprime, m, ml, l, Mp, T);</td></tr>
<tr class="codeline" data-linenumber="903"><td class="num" id="LN903">903</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="904"><td class="num" id="LN904">904</td><td class="line">  h = mpn_mul_fft_internal (op, pl, k, Ap, Bp, A, B, nprime, l, Mp, fft_l, T, sqr);</td></tr>
<tr class="codeline" data-linenumber="905"><td class="num" id="LN905">905</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="906"><td class="num" id="LN906">906</td><td class="line">  <span class='macro'>TMP_FREE<span class='macro_popup'>do { if (__builtin_expect ((__tmp_marker != 0) != 0, 0)) __gmp_tmp_reentrant_free<br> (__tmp_marker); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="907"><td class="num" id="LN907">907</td><td class="line">  <span class='keyword'>return</span> h;</td></tr>
<tr class="codeline" data-linenumber="908"><td class="num" id="LN908">908</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="909"><td class="num" id="LN909">909</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="910"><td class="num" id="LN910">910</td><td class="line"><span class='directive'>#if WANT_OLD_FFT_FULL</span></td></tr>
<tr class="codeline" data-linenumber="911"><td class="num" id="LN911">911</td><td class="line"><span class='comment'>/* multiply {n, nl} by {m, ml}, and put the result in {op, nl+ml} */</span></td></tr>
<tr class="codeline" data-linenumber="912"><td class="num" id="LN912">912</td><td class="line"><span class='keyword'>void</span></td></tr>
<tr class="codeline" data-linenumber="913"><td class="num" id="LN913">913</td><td class="line"><span class='macro'>mpn_mul_fft_full<span class='macro_popup'>__gmpn_mul_fft_full</span></span> (mp_ptr op,</td></tr>
<tr class="codeline" data-linenumber="914"><td class="num" id="LN914">914</td><td class="line">		  mp_srcptr n, mp_size_t nl,</td></tr>
<tr class="codeline" data-linenumber="915"><td class="num" id="LN915">915</td><td class="line">		  mp_srcptr m, mp_size_t ml)</td></tr>
<tr class="codeline" data-linenumber="916"><td class="num" id="LN916">916</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="917"><td class="num" id="LN917">917</td><td class="line">  mp_ptr pad_op;</td></tr>
<tr class="codeline" data-linenumber="918"><td class="num" id="LN918">918</td><td class="line">  mp_size_t pl, pl2, pl3, l;</td></tr>
<tr class="codeline" data-linenumber="919"><td class="num" id="LN919">919</td><td class="line">  mp_size_t cc, c2, oldcc;</td></tr>
<tr class="codeline" data-linenumber="920"><td class="num" id="LN920">920</td><td class="line">  <span class='keyword'>int</span> k2, k3;</td></tr>
<tr class="codeline" data-linenumber="921"><td class="num" id="LN921">921</td><td class="line">  <span class='keyword'>int</span> sqr = (n == m &amp;&amp; nl == ml);</td></tr>
<tr class="codeline" data-linenumber="922"><td class="num" id="LN922">922</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="923"><td class="num" id="LN923">923</td><td class="line">  pl = nl + ml; <span class='comment'>/* total number of limbs of the result */</span></td></tr>
<tr class="codeline" data-linenumber="924"><td class="num" id="LN924">924</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="925"><td class="num" id="LN925">925</td><td class="line">  <span class='comment'>/* perform a fft mod 2^(2N)+1 and one mod 2^(3N)+1.</span></td></tr>
<tr class="codeline" data-linenumber="926"><td class="num" id="LN926">926</td><td class="line">     <span class='comment'>We must have pl3 = 3/2 * pl2, with pl2 a multiple of 2^k2, and</span></td></tr>
<tr class="codeline" data-linenumber="927"><td class="num" id="LN927">927</td><td class="line">     <span class='comment'>pl3 a multiple of 2^k3. Since k3 &gt;= k2, both are multiples of 2^k2,</span></td></tr>
<tr class="codeline" data-linenumber="928"><td class="num" id="LN928">928</td><td class="line">     <span class='comment'>and pl2 must be an even multiple of 2^k2. Thus (pl2,pl3) =</span></td></tr>
<tr class="codeline" data-linenumber="929"><td class="num" id="LN929">929</td><td class="line">     <span class='comment'>(2*j*2^k2,3*j*2^k2), which works for 3*j &lt;= pl/2^k2 &lt;= 5*j.</span></td></tr>
<tr class="codeline" data-linenumber="930"><td class="num" id="LN930">930</td><td class="line">     <span class='comment'>We need that consecutive intervals overlap, i.e. 5*j &gt;= 3*(j+1),</span></td></tr>
<tr class="codeline" data-linenumber="931"><td class="num" id="LN931">931</td><td class="line">     <span class='comment'>which requires j&gt;=2. Thus this scheme requires pl &gt;= 6 * 2^FFT_FIRST_K. */</span></td></tr>
<tr class="codeline" data-linenumber="932"><td class="num" id="LN932">932</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="933"><td class="num" id="LN933">933</td><td class="line">  <span class='comment'>/*  ASSERT_ALWAYS(pl &gt;= 6 * (1 &lt;&lt; FFT_FIRST_K)); */</span></td></tr>
<tr class="codeline" data-linenumber="934"><td class="num" id="LN934">934</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="935"><td class="num" id="LN935">935</td><td class="line">  pl2 = (2 * pl - 1) / 5; <span class='comment'>/* ceil (2pl/5) - 1 */</span></td></tr>
<tr class="codeline" data-linenumber="936"><td class="num" id="LN936">936</td><td class="line">  <span class='keyword'>do</span></td></tr>
<tr class="codeline" data-linenumber="937"><td class="num" id="LN937">937</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="938"><td class="num" id="LN938">938</td><td class="line">      pl2++;</td></tr>
<tr class="codeline" data-linenumber="939"><td class="num" id="LN939">939</td><td class="line">      k2 = <span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (pl2, sqr); <span class='comment'>/* best fft size for pl2 limbs */</span></td></tr>
<tr class="codeline" data-linenumber="940"><td class="num" id="LN940">940</td><td class="line">      pl2 = <span class='macro'>mpn_fft_next_size<span class='macro_popup'>__gmpn_fft_next_size</span></span> (pl2, k2);</td></tr>
<tr class="codeline" data-linenumber="941"><td class="num" id="LN941">941</td><td class="line">      pl3 = 3 * pl2 / 2; <span class='comment'>/* since k&gt;=FFT_FIRST_K=4, pl2 is a multiple of 2^4,</span></td></tr>
<tr class="codeline" data-linenumber="942"><td class="num" id="LN942">942</td><td class="line">			    <span class='comment'>thus pl2 / 2 is exact */</span></td></tr>
<tr class="codeline" data-linenumber="943"><td class="num" id="LN943">943</td><td class="line">      k3 = <span class='macro'>mpn_fft_best_k<span class='macro_popup'>__gmpn_fft_best_k</span></span> (pl3, sqr);</td></tr>
<tr class="codeline" data-linenumber="944"><td class="num" id="LN944">944</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="945"><td class="num" id="LN945">945</td><td class="line">  <span class='keyword'>while</span> (<span class='macro'>mpn_fft_next_size<span class='macro_popup'>__gmpn_fft_next_size</span></span> (pl3, k3) != pl3);</td></tr>
<tr class="codeline" data-linenumber="946"><td class="num" id="LN946">946</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="947"><td class="num" id="LN947">947</td><td class="line">  TRACE (printf (<span class='string_literal'>"mpn_mul_fft_full nl=%ld ml=%ld -&gt; pl2=%ld pl3=%ld k=%d\n"</span>,</td></tr>
<tr class="codeline" data-linenumber="948"><td class="num" id="LN948">948</td><td class="line">		 nl, ml, pl2, pl3, k2));</td></tr>
<tr class="codeline" data-linenumber="949"><td class="num" id="LN949">949</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="950"><td class="num" id="LN950">950</td><td class="line">  <span class='macro'>ASSERT_ALWAYS(pl3 &lt;= pl)<span class='macro_popup'>do { if (__builtin_expect ((!(pl3 &lt;= pl)) != 0, 0)) __gmp_assert_fail<br> ("mul_fft.c", 950, "pl3 &lt;= pl"); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="951"><td class="num" id="LN951">951</td><td class="line">  cc = <span class='macro'>mpn_mul_fft<span class='macro_popup'>__gmpn_mul_fft</span></span> (op, pl3, n, nl, m, ml, k3);     <span class='comment'>/* mu */</span></td></tr>
<tr class="codeline" data-linenumber="952"><td class="num" id="LN952">952</td><td class="line">  <span class='macro'>ASSERT(cc == 0)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="953"><td class="num" id="LN953">953</td><td class="line">  pad_op = <span class='macro'>__GMP_ALLOCATE_FUNC_LIMBS (pl2)<span class='macro_popup'>((mp_limb_t *) (*__gmp_allocate_func) ((pl2) * sizeof (mp_limb_t<br>)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="954"><td class="num" id="LN954">954</td><td class="line">  cc = <span class='macro'>mpn_mul_fft<span class='macro_popup'>__gmpn_mul_fft</span></span> (pad_op, pl2, n, nl, m, ml, k2); <span class='comment'>/* lambda */</span></td></tr>
<tr class="codeline" data-linenumber="955"><td class="num" id="LN955">955</td><td class="line">  cc = -cc + <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (pad_op, pad_op, op, pl2);    <span class='comment'>/* lambda - low(mu) */</span></td></tr>
<tr class="codeline" data-linenumber="956"><td class="num" id="LN956">956</td><td class="line">  <span class='comment'>/* 0 &lt;= cc &lt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="957"><td class="num" id="LN957">957</td><td class="line">  <span class='macro'>ASSERT(0 &lt;= cc &amp;&amp; cc &lt;= 1)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="958"><td class="num" id="LN958">958</td><td class="line">  l = pl3 - pl2; <span class='comment'>/* l = pl2 / 2 since pl3 = 3/2 * pl2 */</span></td></tr>
<tr class="codeline" data-linenumber="959"><td class="num" id="LN959">959</td><td class="line">  c2 = <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (pad_op, pad_op, op + pl2, l);</td></tr>
<tr class="codeline" data-linenumber="960"><td class="num" id="LN960">960</td><td class="line">  cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (pad_op + l, pad_op + l, l, (mp_limb_t) c2) - cc;</td></tr>
<tr class="codeline" data-linenumber="961"><td class="num" id="LN961">961</td><td class="line">  <span class='macro'>ASSERT(-1 &lt;= cc &amp;&amp; cc &lt;= 1)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="962"><td class="num" id="LN962">962</td><td class="line">  <span class='keyword'>if</span> (cc &lt; 0)</td></tr>
<tr class="codeline" data-linenumber="963"><td class="num" id="LN963">963</td><td class="line">    cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (pad_op, pad_op, pl2, (mp_limb_t) -cc);</td></tr>
<tr class="codeline" data-linenumber="964"><td class="num" id="LN964">964</td><td class="line">  <span class='macro'>ASSERT(0 &lt;= cc &amp;&amp; cc &lt;= 1)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="965"><td class="num" id="LN965">965</td><td class="line">  <span class='comment'>/* now lambda-mu = {pad_op, pl2} - cc mod 2^(pl2*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="966"><td class="num" id="LN966">966</td><td class="line">  oldcc = cc;</td></tr>
<tr class="codeline" data-linenumber="967"><td class="num" id="LN967">967</td><td class="line"><span class='directive'>#if HAVE_NATIVE_mpn_add_n_sub_n</span></td></tr>
<tr class="codeline" data-linenumber="968"><td class="num" id="LN968">968</td><td class="line">  c2 = <span class='macro'>mpn_add_n_sub_n<span class='macro_popup'>__gmpn_add_n_sub_n</span></span> (pad_op + l, pad_op, pad_op, pad_op + l, l);</td></tr>
<tr class="codeline" data-linenumber="969"><td class="num" id="LN969">969</td><td class="line">  <span class='comment'>/* c2 &amp; 1 is the borrow, c2 &amp; 2 is the carry */</span></td></tr>
<tr class="codeline" data-linenumber="970"><td class="num" id="LN970">970</td><td class="line">  cc += c2 &gt;&gt; 1; <span class='comment'>/* carry out from high &lt;- low + high */</span></td></tr>
<tr class="codeline" data-linenumber="971"><td class="num" id="LN971">971</td><td class="line">  c2 = c2 &amp; 1; <span class='comment'>/* borrow out from low &lt;- low - high */</span></td></tr>
<tr class="codeline" data-linenumber="972"><td class="num" id="LN972">972</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="973"><td class="num" id="LN973">973</td><td class="line">  {</td></tr>
<tr class="codeline" data-linenumber="974"><td class="num" id="LN974">974</td><td class="line">    mp_ptr tmp;</td></tr>
<tr class="codeline" data-linenumber="975"><td class="num" id="LN975">975</td><td class="line">    <span class='macro'>TMP_DECL<span class='macro_popup'>struct tmp_reentrant_t *__tmp_marker</span></span>;</td></tr>
<tr class="codeline" data-linenumber="976"><td class="num" id="LN976">976</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="977"><td class="num" id="LN977">977</td><td class="line">    <span class='macro'>TMP_MARK<span class='macro_popup'>__tmp_marker = 0</span></span>;</td></tr>
<tr class="codeline" data-linenumber="978"><td class="num" id="LN978">978</td><td class="line">    tmp = <span class='macro'>TMP_BALLOC_LIMBS (l)<span class='macro_popup'>((mp_limb_t *) __gmp_tmp_reentrant_alloc (&amp;__tmp_marker, (<br>l) * sizeof (mp_limb_t)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="979"><td class="num" id="LN979">979</td><td class="line">    <span class='macro'>MPN_COPY (tmp, pad_op, l)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (tmp, pad_op, l); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="980"><td class="num" id="LN980">980</td><td class="line">    c2 = <span class='macro'>mpn_sub_n<span class='macro_popup'>__gmpn_sub_n</span></span> (pad_op,      pad_op, pad_op + l, l);</td></tr>
<tr class="codeline" data-linenumber="981"><td class="num" id="LN981">981</td><td class="line">    cc += <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (pad_op + l, tmp,    pad_op + l, l);</td></tr>
<tr class="codeline" data-linenumber="982"><td class="num" id="LN982">982</td><td class="line">    <span class='macro'>TMP_FREE<span class='macro_popup'>do { if (__builtin_expect ((__tmp_marker != 0) != 0, 0)) __gmp_tmp_reentrant_free<br> (__tmp_marker); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="983"><td class="num" id="LN983">983</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="984"><td class="num" id="LN984">984</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="985"><td class="num" id="LN985">985</td><td class="line">  c2 += oldcc;</td></tr>
<tr class="codeline" data-linenumber="986"><td class="num" id="LN986">986</td><td class="line">  <span class='comment'>/* first normalize {pad_op, pl2} before dividing by 2: c2 is the borrow</span></td></tr>
<tr class="codeline" data-linenumber="987"><td class="num" id="LN987">987</td><td class="line">     <span class='comment'>at pad_op + l, cc is the carry at pad_op + pl2 */</span></td></tr>
<tr class="codeline" data-linenumber="988"><td class="num" id="LN988">988</td><td class="line">  <span class='comment'>/* 0 &lt;= cc &lt;= 2 */</span></td></tr>
<tr class="codeline" data-linenumber="989"><td class="num" id="LN989">989</td><td class="line">  cc -= <span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (pad_op + l, pad_op + l, l, (mp_limb_t) c2);</td></tr>
<tr class="codeline" data-linenumber="990"><td class="num" id="LN990">990</td><td class="line">  <span class='comment'>/* -1 &lt;= cc &lt;= 2 */</span></td></tr>
<tr class="codeline" data-linenumber="991"><td class="num" id="LN991">991</td><td class="line">  <span class='keyword'>if</span> (cc &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="992"><td class="num" id="LN992">992</td><td class="line">    cc = -<span class='macro'>mpn_sub_1<span class='macro_popup'>__gmpn_sub_1</span></span> (pad_op, pad_op, pl2, (mp_limb_t) cc);</td></tr>
<tr class="codeline" data-linenumber="993"><td class="num" id="LN993">993</td><td class="line">  <span class='comment'>/* now -1 &lt;= cc &lt;= 0 */</span></td></tr>
<tr class="codeline" data-linenumber="994"><td class="num" id="LN994">994</td><td class="line">  <span class='keyword'>if</span> (cc &lt; 0)</td></tr>
<tr class="codeline" data-linenumber="995"><td class="num" id="LN995">995</td><td class="line">    cc = <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (pad_op, pad_op, pl2, (mp_limb_t) -cc);</td></tr>
<tr class="codeline" data-linenumber="996"><td class="num" id="LN996">996</td><td class="line">  <span class='comment'>/* now {pad_op, pl2} is normalized, with 0 &lt;= cc &lt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="997"><td class="num" id="LN997">997</td><td class="line">  <span class='keyword'>if</span> (pad_op[0] &amp; 1) <span class='comment'>/* if odd, add 2^(pl2*GMP_NUMB_BITS)+1 */</span></td></tr>
<tr class="codeline" data-linenumber="998"><td class="num" id="LN998">998</td><td class="line">    cc += 1 + <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (pad_op, pad_op, pl2, <span class='macro'>CNST_LIMB(1)<span class='macro_popup'>((mp_limb_t) 1L)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="999"><td class="num" id="LN999">999</td><td class="line">  <span class='comment'>/* now 0 &lt;= cc &lt;= 2, but cc=2 cannot occur since it would give a carry</span></td></tr>
<tr class="codeline" data-linenumber="1000"><td class="num" id="LN1000">1000</td><td class="line">     <span class='comment'>out below */</span></td></tr>
<tr class="codeline" data-linenumber="1001"><td class="num" id="LN1001">1001</td><td class="line">  <span class='macro'>mpn_rshift<span class='macro_popup'>__gmpn_rshift</span></span> (pad_op, pad_op, pl2, 1); <span class='comment'>/* divide by two */</span></td></tr>
<tr class="codeline" data-linenumber="1002"><td class="num" id="LN1002">1002</td><td class="line">  <span class='keyword'>if</span> (cc) <span class='comment'>/* then cc=1 */</span></td></tr>
<tr class="codeline" data-linenumber="1003"><td class="num" id="LN1003">1003</td><td class="line">    pad_op [pl2 - 1] |= (mp_limb_t) 1 &lt;&lt; (<span class='macro'>GMP_NUMB_BITS<span class='macro_popup'>(64 - 0)</span></span> - 1);</td></tr>
<tr class="codeline" data-linenumber="1004"><td class="num" id="LN1004">1004</td><td class="line">  <span class='comment'>/* now {pad_op,pl2}-cc = (lambda-mu)/(1-2^(l*GMP_NUMB_BITS))</span></td></tr>
<tr class="codeline" data-linenumber="1005"><td class="num" id="LN1005">1005</td><td class="line">     <span class='comment'>mod 2^(pl2*GMP_NUMB_BITS) + 1 */</span></td></tr>
<tr class="codeline" data-linenumber="1006"><td class="num" id="LN1006">1006</td><td class="line">  c2 = <span class='macro'>mpn_add_n<span class='macro_popup'>__gmpn_add_n</span></span> (op, op, pad_op, pl2); <span class='comment'>/* no need to add cc (is 0) */</span></td></tr>
<tr class="codeline" data-linenumber="1007"><td class="num" id="LN1007">1007</td><td class="line">  <span class='comment'>/* since pl2+pl3 &gt;= pl, necessary the extra limbs (including cc) are zero */</span></td></tr>
<tr class="codeline" data-linenumber="1008"><td class="num" id="LN1008">1008</td><td class="line">  <span class='macro'>MPN_COPY (op + pl3, pad_op, pl - pl3)<span class='macro_popup'>do { do {} while (0); do { do {} while (0); do {} while (0); __gmpn_copyi<br> (op + pl3, pad_op, pl - pl3); } while (0); } while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="1009"><td class="num" id="LN1009">1009</td><td class="line">  <span class='macro'>ASSERT_MPN_ZERO_P (pad_op + pl - pl3, pl2 + pl3 - pl)<span class='macro_popup'>do {} while (0)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="1010"><td class="num" id="LN1010">1010</td><td class="line">  <span class='macro'>__GMP_FREE_FUNC_LIMBS (pad_op, pl2)<span class='macro_popup'>(*__gmp_free_func) (pad_op, (pl2) * sizeof (mp_limb_t))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="1011"><td class="num" id="LN1011">1011</td><td class="line">  <span class='comment'>/* since the final result has at most pl limbs, no carry out below */</span></td></tr>
<tr class="codeline" data-linenumber="1012"><td class="num" id="LN1012">1012</td><td class="line">  <span class='macro'>mpn_add_1<span class='macro_popup'>__gmpn_add_1</span></span> (op + pl2, op + pl2, pl - pl2, (mp_limb_t) c2);</td></tr>
<tr class="codeline" data-linenumber="1013"><td class="num" id="LN1013">1013</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1014"><td class="num" id="LN1014">1014</td><td class="line"><span class='directive'>#endif</span></td></tr>
</table></body></html>
